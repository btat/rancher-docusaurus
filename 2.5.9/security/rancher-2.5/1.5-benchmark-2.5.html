<!doctype html>
<html class="docs-version-2.5.9" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">CIS 1.5 Benchmark - Self-Assessment Guide - Rancher v2.5 | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://btat.github.io/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-benchmark-2.5"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.5.9"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.5.9"><meta data-react-helmet="true" property="og:title" content="CIS 1.5 Benchmark - Self-Assessment Guide - Rancher v2.5 | My Site"><meta data-react-helmet="true" name="description" content="CIS v1.5 Kubernetes Benchmark - Rancher v2.5 with Kubernetes v1.15"><meta data-react-helmet="true" property="og:description" content="CIS v1.5 Kubernetes Benchmark - Rancher v2.5 with Kubernetes v1.15"><link data-react-helmet="true" rel="shortcut icon" href="/rancher-docusaurus/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://btat.github.io/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-benchmark-2.5"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-benchmark-2.5" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-benchmark-2.5" hreflang="x-default"><link rel="stylesheet" href="/rancher-docusaurus/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/rancher-docusaurus/assets/js/runtime~main.e49194ca.js" as="script">
<link rel="preload" href="/rancher-docusaurus/assets/js/main.ed945e9c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rancher-docusaurus/"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Rancher Docs</b></a><a href="https://suse-projects.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>More SUSE Projects<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Rancher Deployment Quick Start Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installing/Upgrading Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Best Practices Guide</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Backups and Disaster Recovery</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Authentication, Permissions and Global Configuration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Setting up Kubernetes Clusters in Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cluster Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Project Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pipelines</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deploying Applications across Clusters</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Monitoring and Alerting</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Istio</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Logging</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CIS Scans</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes Resources</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Security</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/cve">Rancher CVEs and Resolutions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/index">Intro</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">rancher-2.5</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-benchmark-2.5">CIS 1.5 Benchmark - Self-Assessment Guide - Rancher v2.5</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-hardening-2.5">Hardening Guide with CIS 1.5 Benchmark</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/rancher-2.5/1.6-benchmark-2.5">CIS 1.6 Benchmark - Self-Assessment Guide - Rancher v2.5.4</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/rancher-2.5/1.6-hardening-2.5">Hardening Guide with CIS 1.6 Benchmark</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/rancher-2.5/index">Self-Assessment and Hardening Guides for Rancher v2.5</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/security-scan">Security Scans</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/2.5.9/security/selinux">SELinux RPM</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Settings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FAQ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9/cli">Using the Rancher Command Line Interface</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9/contributing">Contributing to Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9/helm-charts">Helm Charts in Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9">Rancher 2.6</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9/longhorn">Longhorn - Cloud native distributed block storage for Kubernetes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9/opa-gatekeper">OPA Gatekeeper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/2.5.9/system-tools">System Tools</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for My Site <b>2.5.9</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/rancher-docusaurus/security/rancher-2.5/1.5-benchmark-2.5">latest version</a></b> (2.4.15).</div></div><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 2.5.9</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CIS 1.5 Benchmark - Self-Assessment Guide - Rancher v2.5</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="cis-v15-kubernetes-benchmark---rancher-v25-with-kubernetes-v115"></a>CIS v1.5 Kubernetes Benchmark - Rancher v2.5 with Kubernetes v1.15<a class="hash-link" href="#cis-v15-kubernetes-benchmark---rancher-v25-with-kubernetes-v115" title="Direct link to heading">#</a></h3><p><a href="https://releases.rancher.com/documents/security/2.5/Rancher_1.5_Benchmark_Assessment.pdf" target="_blank" rel="noopener noreferrer">Click here to download a PDF version of this document</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h4><p>This document is a companion to the Rancher v2.5 security hardening guide. The hardening guide provides prescriptive guidance for hardening a production installation of Rancher, and this benchmark guide is meant to help you evaluate the level of security of the hardened cluster against each control in the benchmark.</p><p>This guide corresponds to specific versions of the hardening guide, Rancher, CIS Benchmark, and Kubernetes:</p><table><thead><tr><th>Hardening Guide Version</th><th>Rancher Version</th><th>CIS Benchmark Version</th><th>Kubernetes Version</th></tr></thead><tbody><tr><td>Hardening Guide with CIS 1.5 Benchmark</td><td>Rancher v2.5</td><td>CIS v1.5</td><td>Kubernetes v1.15</td></tr></tbody></table><p>Because Rancher and RKE install Kubernetes services as Docker containers, many of the control verification checks in the CIS Kubernetes Benchmark don&#x27;t apply and will have a result of <code>Not Applicable</code>. This guide will walk through the various controls and provide updated example commands to audit compliance in Rancher-created clusters.</p><p>This document is to be used by Rancher operators, security teams, auditors and decision makers.</p><p>For more detail about each audit, including rationales and remediations for failing tests, you can refer to the corresponding section of the CIS Kubernetes Benchmark v1.5. You can download the benchmark after logging in to <a href="https://www.cisecurity.org/benchmark/kubernetes/" target="_blank" rel="noopener noreferrer">CISecurity.org</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="testing-controls-methodology"></a>Testing controls methodology<a class="hash-link" href="#testing-controls-methodology" title="Direct link to heading">#</a></h4><p>Rancher and RKE install Kubernetes services via Docker containers. Configuration is defined by arguments passed to the container at the time of initialization, not via configuration files.</p><p>Where control audits differ from the original CIS benchmark, the audit commands specific to Rancher Labs are provided for testing.
When performing the tests, you will need access to the Docker command line on the hosts of all three RKE roles. The commands also make use of the the <a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener noreferrer">jq</a> and <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">kubectl</a> (with valid config) tools to and are required in the testing and evaluation of test results.</p><p>&gt; NOTE: only scored tests are covered in this guide.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="controls"></a>Controls<a class="hash-link" href="#controls" title="Direct link to heading">#</a></h3><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="1-master-node-security-configuration"></a>1 Master Node Security Configuration<a class="hash-link" href="#1-master-node-security-configuration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="11-master-node-configuration-files"></a>1.1 Master Node Configuration Files<a class="hash-link" href="#11-master-node-configuration-files" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="111-ensure-that-the-api-server-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.1 Ensure that the API server pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#111-ensure-that-the-api-server-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the API server. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="112-ensure-that-the-api-server-pod-specification-file-ownership-is-set-to-rootroot-scored"></a>1.1.2 Ensure that the API server pod specification file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#112-ensure-that-the-api-server-pod-specification-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the API server. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="113-ensure-that-the-controller-manager-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.3 Ensure that the controller manager pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#113-ensure-that-the-controller-manager-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the controller manager. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="114-ensure-that-the-controller-manager-pod-specification-file-ownership-is-set-to-rootroot-scored"></a>1.1.4 Ensure that the controller manager pod specification file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#114-ensure-that-the-controller-manager-pod-specification-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the controller manager. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="115-ensure-that-the-scheduler-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.5 Ensure that the scheduler pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#115-ensure-that-the-scheduler-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the scheduler. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="116-ensure-that-the-scheduler-pod-specification-file-ownership-is-set-to-rootroot-scored"></a>1.1.6 Ensure that the scheduler pod specification file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#116-ensure-that-the-scheduler-pod-specification-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the scheduler. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="117-ensure-that-the-etcd-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.7 Ensure that the etcd pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#117-ensure-that-the-etcd-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="118-ensure-that-the-etcd-pod-specification-file-ownership-is-set-to-rootroot-scored"></a>1.1.8 Ensure that the etcd pod specification file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#118-ensure-that-the-etcd-pod-specification-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1111-ensure-that-the-etcd-data-directory-permissions-are-set-to-700-or-more-restrictive-scored"></a>1.1.11 Ensure that the etcd data directory permissions are set to <code>700</code> or more restrictive (Scored)<a class="hash-link" href="#1111-ensure-that-the-etcd-data-directory-permissions-are-set-to-700-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
On the etcd server node, get the etcd data directory, passed as an argument <code>--data-dir</code>,
from the below command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -ef </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> etcd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Run the below command (based on the etcd data directory found above). For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">700</span><span class="token plain"> /var/lib/etcd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Script:</strong> 1.1.11.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd_bin=${1}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">test_dir=$(ps -ef | grep ${etcd_bin} | grep -- --data-dir | sed &#x27;s%.*data-dir[= ]\([^ ]*\).*%\1%&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker inspect etcd | jq -r &#x27;.[].HostConfig.Binds[]&#x27; | grep &quot;${test_dir}&quot; | cut -d &quot;:&quot; -f 1 | xargs stat -c %a</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./1.1.11.sh etcd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;700&#x27; is equal to &#x27;700&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1112-ensure-that-the-etcd-data-directory-ownership-is-set-to-etcdetcd-scored"></a>1.1.12 Ensure that the etcd data directory ownership is set to <code>etcd:etcd</code> (Scored)<a class="hash-link" href="#1112-ensure-that-the-etcd-data-directory-ownership-is-set-to-etcdetcd-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
On the etcd server node, get the etcd data directory, passed as an argument <code>--data-dir</code>,
from the below command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -ef </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> etcd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Run the below command (based on the etcd data directory found above).
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> etcd:etcd /var/lib/etcd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Script:</strong> 1.1.12.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd_bin=${1}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">test_dir=$(ps -ef | grep ${etcd_bin} | grep -- --data-dir | sed &#x27;s%.*data-dir[= ]\([^ ]*\).*%\1%&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker inspect etcd | jq -r &#x27;.[].HostConfig.Binds[]&#x27; | grep &quot;${test_dir}&quot; | cut -d &quot;:&quot; -f 1 | xargs stat -c %U:%G</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./1.1.12.sh etcd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;etcd:etcd&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1113-ensure-that-the-adminconf-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.13 Ensure that the <code>admin.conf</code> file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#1113-ensure-that-the-adminconf-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE does not store the kubernetes default kubeconfig credentials file on the nodes. Itâ€™s presented to user where RKE is run.
We recommend that this <code>kube_config_cluster.yml</code> file be kept in secure store.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1114-ensure-that-the-adminconf-file-ownership-is-set-to-rootroot-scored"></a>1.1.14 Ensure that the admin.conf file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#1114-ensure-that-the-adminconf-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE does not store the kubernetes default kubeconfig credentials file on the nodes. Itâ€™s presented to user where RKE is run.
We recommend that this <code>kube_config_cluster.yml</code> file be kept in secure store.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1115-ensure-that-the-schedulerconf-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.15 Ensure that the <code>scheduler.conf</code> file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#1115-ensure-that-the-schedulerconf-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the scheduler. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1116-ensure-that-the-schedulerconf-file-ownership-is-set-to-rootroot-scored"></a>1.1.16 Ensure that the <code>scheduler.conf</code> file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#1116-ensure-that-the-schedulerconf-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the scheduler. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1117-ensure-that-the-controller-managerconf-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.17 Ensure that the <code>controller-manager.conf</code> file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#1117-ensure-that-the-controller-managerconf-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the controller manager. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1118-ensure-that-the-controller-managerconf-file-ownership-is-set-to-rootroot-scored"></a>1.1.18 Ensure that the <code>controller-manager.conf</code> file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#1118-ensure-that-the-controller-managerconf-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the controller manager. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1119-ensure-that-the-kubernetes-pki-directory-and-file-ownership-is-set-to-rootroot-scored"></a>1.1.19 Ensure that the Kubernetes PKI directory and file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#1119-ensure-that-the-kubernetes-pki-directory-and-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the master node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> -R root:root /etc/kubernetes/ssl</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">stat -c %U:%G /etc/kubernetes/ssl</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;root:root&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1120-ensure-that-the-kubernetes-pki-certificate-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>1.1.20 Ensure that the Kubernetes PKI certificate file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#1120-ensure-that-the-kubernetes-pki-certificate-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the master node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">644</span><span class="token plain"> /etc/kubernetes/ssl</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Script:</strong> check_files_permissions.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env bash</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># This script is used to ensure the file permissions are set to 644 or</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># more restrictive for all files in a given directory or a wildcard</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># selection of files</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># inputs:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#   $1 = /full/path/to/directory or /path/to/fileswithpattern</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#                                   ex: !(*key).pem</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#   $2 (optional) = permission (ex: 600)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># outputs:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#   true/false</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Turn on &quot;extended glob&quot; for use of &#x27;!&#x27; in wildcard</span></span><span class="token-line" style="color:#393A34"><span class="token plain">shopt -s extglob</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Turn off history to avoid surprises when using &#x27;!&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">set -H</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">USER_INPUT=$1</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ &quot;${USER_INPUT}&quot; == &quot;&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;false&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ -d ${USER_INPUT} ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  PATTERN=&quot;${USER_INPUT}/*&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  PATTERN=&quot;${USER_INPUT}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">PERMISSION=&quot;&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ &quot;$2&quot; != &quot;&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  PERMISSION=$2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FILES_PERMISSIONS=$(stat -c %n\ %a ${PATTERN})</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">while read -r fileInfo; do</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  p=$(echo ${fileInfo} | cut -d&#x27; &#x27; -f2)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if [[ &quot;${PERMISSION}&quot; != &quot;&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if [[ &quot;$p&quot; != &quot;${PERMISSION}&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      echo &quot;false&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      exit</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  else</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if [[ &quot;$p&quot; != &quot;644&quot; &amp;&amp; &quot;$p&quot; != &quot;640&quot; &amp;&amp; &quot;$p&quot; != &quot;600&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      echo &quot;false&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      exit</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain">done \&lt;\&lt;\&lt; &quot;${FILES_PERMISSIONS}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;true&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">exit</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./check_files_permissions.sh &#x27;/etc/kubernetes/ssl/*.pem&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1121-ensure-that-the-kubernetes-pki-key-file-permissions-are-set-to-600-scored"></a>1.1.21 Ensure that the Kubernetes PKI key file permissions are set to <code>600</code> (Scored)<a class="hash-link" href="#1121-ensure-that-the-kubernetes-pki-key-file-permissions-are-set-to-600-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the master node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> /etc/kubernetes/ssl/certs/serverca</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Script:</strong> 1.1.21.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain">check_dir=${1:-/etc/kubernetes/ssl}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">for file in $(find ${check_dir} -name &quot;*key.pem&quot;); do</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    file_permission=$(stat -c %a ${file})</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if [[ &quot;${file_permission}&quot; == &quot;600&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    continue</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  else</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;FAIL: ${file} ${file_permission}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;pass&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./1.1.21.sh /etc/kubernetes/ssl</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;pass&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="12-api-server"></a>1.2 API Server<a class="hash-link" href="#12-api-server" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="122-ensure-that-the---basic-auth-file-argument-is-not-set-scored"></a>1.2.2 Ensure that the <code>--basic-auth-file</code> argument is not set (Scored)<a class="hash-link" href="#122-ensure-that-the---basic-auth-file-argument-is-not-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the documentation and configure alternate mechanisms for authentication. Then,
edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and remove the <code>--basic-auth-file=\&lt;filename\&gt;</code> parameter.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--basic-auth-file&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="123-ensure-that-the---token-auth-file-parameter-is-not-set-scored"></a>1.2.3 Ensure that the <code>--token-auth-file</code> parameter is not set (Scored)<a class="hash-link" href="#123-ensure-that-the---token-auth-file-parameter-is-not-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the documentation and configure alternate mechanisms for authentication. Then,
edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and remove the <code>--token-auth-file=\&lt;filename\&gt;</code> parameter.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--token-auth-file&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="124-ensure-that-the---kubelet-https-argument-is-set-to-true-scored"></a>1.2.4 Ensure that the <code>--kubelet-https</code> argument is set to true (Scored)<a class="hash-link" href="#124-ensure-that-the---kubelet-https-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
on the master node and remove the <code>--kubelet-https</code> parameter.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--kubelet-https&#x27; is present OR &#x27;--kubelet-https&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="125-ensure-that-the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-set-as-appropriate-scored"></a>1.2.5 Ensure that the <code>--kubelet-client-certificate</code> and <code>--kubelet-client-key</code> arguments are set as appropriate (Scored)<a class="hash-link" href="#125-ensure-that-the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and set up the TLS connection between the
apiserver and kubelets. Then, edit API server pod specification file
<code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> on the master node and set the
kubelet client certificate and key parameters as below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--kubelet-client-certificate</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/client-certificate-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">--kubelet-client-key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/client-key-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--kubelet-client-certificate&#x27; is present AND &#x27;--kubelet-client-key&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="126-ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-scored"></a>1.2.6 Ensure that the <code>--kubelet-certificate-authority</code> argument is set as appropriate (Scored)<a class="hash-link" href="#126-ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and setup the TLS connection between
the apiserver and kubelets. Then, edit the API server pod specification file
<code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> on the master node and set the
<code>--kubelet-certificate-authority</code> parameter to the path to the cert file for the certificate authority.
<code>--kubelet-certificate-authority=\&lt;ca-string\&gt;</code></p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--kubelet-certificate-authority&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="127-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored"></a>1.2.7 Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)<a class="hash-link" href="#127-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--authorization-mode</code> parameter to values other than <code>AlwaysAllow</code>.
One such example could be as below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--authorization-mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">RBAC</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;Node,RBAC&#x27; not have &#x27;AlwaysAllow&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="128-ensure-that-the---authorization-mode-argument-includes-node-scored"></a>1.2.8 Ensure that the <code>--authorization-mode</code> argument includes <code>Node</code> (Scored)<a class="hash-link" href="#128-ensure-that-the---authorization-mode-argument-includes-node-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--authorization-mode</code> parameter to a value that includes <code>Node</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--authorization-mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Node,RBAC</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;Node,RBAC&#x27; has &#x27;Node&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="129-ensure-that-the---authorization-mode-argument-includes-rbac-scored"></a>1.2.9 Ensure that the <code>--authorization-mode</code> argument includes <code>RBAC</code> (Scored)<a class="hash-link" href="#129-ensure-that-the---authorization-mode-argument-includes-rbac-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--authorization-mode</code> parameter to a value that includes RBAC,
for example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--authorization-mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Node,RBAC</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;Node,RBAC&#x27; has &#x27;RBAC&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1211-ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-scored"></a>1.2.11 Ensure that the admission control plugin <code>AlwaysAdmit</code> is not set (Scored)<a class="hash-link" href="#1211-ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and either remove the <code>--enable-admission-plugins</code> parameter, or set it to a
value that does not include <code>AlwaysAdmit</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction,Priority,TaintNodesByCondition,PersistentVolumeClaimResize,PodSecurityPolicy,EventRateLimit&#x27; not have &#x27;AlwaysAdmit&#x27; OR &#x27;--enable-admission-plugins&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1214-ensure-that-the-admission-control-plugin-serviceaccount-is-set-scored"></a>1.2.14 Ensure that the admission control plugin <code>ServiceAccount</code> is set (Scored)<a class="hash-link" href="#1214-ensure-that-the-admission-control-plugin-serviceaccount-is-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the documentation and create ServiceAccount objects as per your environment.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and ensure that the <code>--disable-admission-plugins</code> parameter is set to a
value that does not include <code>ServiceAccount</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction,Priority,TaintNodesByCondition,PersistentVolumeClaimResize,PodSecurityPolicy,EventRateLimit&#x27; has &#x27;ServiceAccount&#x27; OR &#x27;--enable-admission-plugins&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1215-ensure-that-the-admission-control-plugin-namespacelifecycle-is-set-scored"></a>1.2.15 Ensure that the admission control plugin <code>NamespaceLifecycle</code> is set (Scored)<a class="hash-link" href="#1215-ensure-that-the-admission-control-plugin-namespacelifecycle-is-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--disable-admission-plugins</code> parameter to
ensure it does not include <code>NamespaceLifecycle</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--disable-admission-plugins&#x27; is present OR &#x27;--disable-admission-plugins&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1216-ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set-scored"></a>1.2.16 Ensure that the admission control plugin <code>PodSecurityPolicy</code> is set (Scored)<a class="hash-link" href="#1216-ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the documentation and create Pod Security Policy objects as per your environment.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--enable-admission-plugins</code> parameter to a
value that includes <code>PodSecurityPolicy</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--enable-admission-plugins</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.,PodSecurityPolicy,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then restart the API Server.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction,Priority,TaintNodesByCondition,PersistentVolumeClaimResize,PodSecurityPolicy,EventRateLimit&#x27; has &#x27;PodSecurityPolicy&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1217-ensure-that-the-admission-control-plugin-noderestriction-is-set-scored"></a>1.2.17 Ensure that the admission control plugin <code>NodeRestriction</code> is set (Scored)<a class="hash-link" href="#1217-ensure-that-the-admission-control-plugin-noderestriction-is-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and configure <code>NodeRestriction</code> plug-in on kubelets.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--enable-admission-plugins</code> parameter to a
value that includes <code>NodeRestriction</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--enable-admission-plugins</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.,NodeRestriction,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction,Priority,TaintNodesByCondition,PersistentVolumeClaimResize,PodSecurityPolicy,EventRateLimit&#x27; has &#x27;NodeRestriction&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1218-ensure-that-the---insecure-bind-address-argument-is-not-set-scored"></a>1.2.18 Ensure that the <code>--insecure-bind-address</code> argument is not set (Scored)<a class="hash-link" href="#1218-ensure-that-the---insecure-bind-address-argument-is-not-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and remove the <code>--insecure-bind-address</code> parameter.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--insecure-bind-address&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1219-ensure-that-the---insecure-port-argument-is-set-to-0-scored"></a>1.2.19 Ensure that the <code>--insecure-port</code> argument is set to <code>0</code> (Scored)<a class="hash-link" href="#1219-ensure-that-the---insecure-port-argument-is-set-to-0-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--insecure-port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0&#x27; is equal to &#x27;0&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1220-ensure-that-the---secure-port-argument-is-not-set-to-0-scored"></a>1.2.20 Ensure that the <code>--secure-port</code> argument is not set to <code>0</code> (Scored)<a class="hash-link" href="#1220-ensure-that-the---secure-port-argument-is-not-set-to-0-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and either remove the <code>--secure-port</code> parameter or
set it to a different <strong>(non-zero)</strong> desired port.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">6443 is greater than 0 OR &#x27;--secure-port&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1221-ensure-that-the---profiling-argument-is-set-to-false-scored"></a>1.2.21 Ensure that the <code>--profiling</code> argument is set to <code>false</code> (Scored)<a class="hash-link" href="#1221-ensure-that-the---profiling-argument-is-set-to-false-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--profiling</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;false&#x27; is equal to &#x27;false&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1222-ensure-that-the---audit-log-path-argument-is-set-scored"></a>1.2.22 Ensure that the <code>--audit-log-path</code> argument is set (Scored)<a class="hash-link" href="#1222-ensure-that-the---audit-log-path-argument-is-set-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--audit-log-path</code> parameter to a suitable path and
file where you would like audit logs to be written, for example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--audit-log-path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/log/apiserver/audit.log</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--audit-log-path&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1223-ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-scored"></a>1.2.23 Ensure that the <code>--audit-log-maxage</code> argument is set to <code>30</code> or as appropriate (Scored)<a class="hash-link" href="#1223-ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--audit-log-maxage</code> parameter to <code>30</code> or as an appropriate number of days:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--audit-log-maxage</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">30</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">30 is greater or equal to 30</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1224-ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-scored"></a>1.2.24 Ensure that the <code>--audit-log-maxbackup</code> argument is set to <code>10</code> or as appropriate (Scored)<a class="hash-link" href="#1224-ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--audit-log-maxbackup</code> parameter to <code>10</code> or to an appropriate
value.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--audit-log-maxbackup</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">10 is greater or equal to 10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1225-ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-scored"></a>1.2.25 Ensure that the <code>--audit-log-maxsize</code> argument is set to <code>100</code> or as appropriate (Scored)<a class="hash-link" href="#1225-ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--audit-log-maxsize</code> parameter to an appropriate size in <strong>MB</strong>.
For example, to set it as <code>100</code> <strong>MB</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--audit-log-maxsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">100 is greater or equal to 100</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1226-ensure-that-the---request-timeout-argument-is-set-as-appropriate-scored"></a>1.2.26 Ensure that the <code>--request-timeout</code> argument is set as appropriate (Scored)<a class="hash-link" href="#1226-ensure-that-the---request-timeout-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
and set the below parameter as appropriate and if needed.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--request-timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">300s</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--request-timeout&#x27; is not present OR &#x27;--request-timeout&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1227-ensure-that-the---service-account-lookup-argument-is-set-to-true-scored"></a>1.2.27 Ensure that the <code>--service-account-lookup</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#1227-ensure-that-the---service-account-lookup-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--service-account-lookup</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Alternatively, you can delete the <code>--service-account-lookup</code> parameter from this file so
that the default takes effect.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--service-account-lookup&#x27; is not present OR &#x27;true&#x27; is equal to &#x27;true&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1228-ensure-that-the---service-account-key-file-argument-is-set-as-appropriate-scored"></a>1.2.28 Ensure that the <code>--service-account-key-file</code> argument is set as appropriate (Scored)<a class="hash-link" href="#1228-ensure-that-the---service-account-key-file-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--service-account-key-file</code> parameter
to the public key file for service accounts:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--service-account-key-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--service-account-key-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1229-ensure-that-the---etcd-certfile-and---etcd-keyfile-arguments-are-set-as-appropriate-scored"></a>1.2.29 Ensure that the <code>--etcd-certfile</code> and <code>--etcd-keyfile</code> arguments are set as appropriate (Scored)<a class="hash-link" href="#1229-ensure-that-the---etcd-certfile-and---etcd-keyfile-arguments-are-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and set up the TLS connection between the apiserver and etcd.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <strong>etcd</strong> certificate and <strong>key</strong> file parameters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--etcd-certfile</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/client-certificate-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">--etcd-keyfile</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/client-key-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--etcd-certfile&#x27; is present AND &#x27;--etcd-keyfile&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1230-ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored"></a>1.2.30 Ensure that the <code>--tls-cert-file</code> and <code>--tls-private-key-file</code> arguments are set as appropriate (Scored)<a class="hash-link" href="#1230-ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and set up the TLS connection on the apiserver.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the TLS certificate and private key file parameters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--tls-cert-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/tls-certificate-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">--tls-private-key-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/tls-key-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--tls-cert-file&#x27; is present AND &#x27;--tls-private-key-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1231-ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored"></a>1.2.31 Ensure that the <code>--client-ca-file</code> argument is set as appropriate (Scored)<a class="hash-link" href="#1231-ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and set up the TLS connection on the apiserver.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the client certificate authority file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--client-ca-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/client-ca-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--client-ca-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1232-ensure-that-the---etcd-cafile-argument-is-set-as-appropriate-scored"></a>1.2.32 Ensure that the <code>--etcd-cafile</code> argument is set as appropriate (Scored)<a class="hash-link" href="#1232-ensure-that-the---etcd-cafile-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and set up the TLS connection between the apiserver and etcd.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the etcd certificate authority file parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--etcd-cafile</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/ca-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--etcd-cafile&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1233-ensure-that-the---encryption-provider-config-argument-is-set-as-appropriate-scored"></a>1.2.33 Ensure that the <code>--encryption-provider-config</code> argument is set as appropriate (Scored)<a class="hash-link" href="#1233-ensure-that-the---encryption-provider-config-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and configure a EncryptionConfig file.
Then, edit the API server pod specification file <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>
on the master node and set the <code>--encryption-provider-config</code> parameter to the path of that file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--encryption-provider-config</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/path/to/EncryptionConfig/File</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-apiserver | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--encryption-provider-config&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="1234-ensure-that-encryption-providers-are-appropriately-configured-scored"></a>1.2.34 Ensure that encryption providers are appropriately configured (Scored)<a class="hash-link" href="#1234-ensure-that-encryption-providers-are-appropriately-configured-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the Kubernetes documentation and configure a <code>EncryptionConfig</code> file.
In this file, choose <strong>aescbc</strong>, <strong>kms</strong> or <strong>secretbox</strong> as the encryption provider.</p><p><strong>Audit Script:</strong> 1.2.34.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">check_file=${1}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">grep -q -E &#x27;aescbc|kms|secretbox&#x27; ${check_file}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ $? -eq 0 ]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;--pass&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;fail: encryption provider found in ${check_file}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./1.2.34.sh /etc/kubernetes/ssl/encryption.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--pass&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="13-controller-manager"></a>1.3 Controller Manager<a class="hash-link" href="#13-controller-manager" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="131-ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-scored"></a>1.3.1 Ensure that the <code>--terminated-pod-gc-threshold</code> argument is set as appropriate (Scored)<a class="hash-link" href="#131-ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node and set the <code>--terminated-pod-gc-threshold</code> to an appropriate threshold,
for example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--terminated-pod-gc-threshold</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--terminated-pod-gc-threshold&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="132-ensure-that-the---profiling-argument-is-set-to-false-scored"></a>1.3.2 Ensure that the <code>--profiling</code> argument is set to false (Scored)<a class="hash-link" href="#132-ensure-that-the---profiling-argument-is-set-to-false-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--profiling</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;false&#x27; is equal to &#x27;false&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="133-ensure-that-the---use-service-account-credentials-argument-is-set-to-true-scored"></a>1.3.3 Ensure that the <code>--use-service-account-credentials</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#133-ensure-that-the---use-service-account-credentials-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node to set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--use-service-account-credentials</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is not equal to &#x27;false&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="134-ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-scored"></a>1.3.4 Ensure that the <code>--service-account-private-key-file</code> argument is set as appropriate (Scored)<a class="hash-link" href="#134-ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node and set the <code>--service-account-private-key-file</code> parameter
to the private key file for service accounts.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--service-account-private-key-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--service-account-private-key-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="135-ensure-that-the---root-ca-file-argument-is-set-as-appropriate-scored"></a>1.3.5 Ensure that the <code>--root-ca-file</code> argument is set as appropriate (Scored)<a class="hash-link" href="#135-ensure-that-the---root-ca-file-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node and set the <code>--root-ca-file</code> parameter to the certificate bundle file`.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--root-ca-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--root-ca-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="136-ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored"></a>1.3.6 Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#136-ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node and set the <code>--feature-gates</code> parameter to include <code>RotateKubeletServerCertificate=true</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--feature-gates</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">RotateKubeletServerCertificate</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;RotateKubeletServerCertificate=true&#x27; is equal to &#x27;RotateKubeletServerCertificate=true&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="137-ensure-that-the---bind-address-argument-is-set-to-127001-scored"></a>1.3.7 Ensure that the <code>--bind-address argument</code> is set to <code>127.0.0.1</code> (Scored)<a class="hash-link" href="#137-ensure-that-the---bind-address-argument-is-set-to-127001-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>
on the master node and ensure the correct value for the <code>--bind-address</code> parameter.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-controller-manager | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--bind-address&#x27; is present OR &#x27;--bind-address&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="14-scheduler"></a>1.4 Scheduler<a class="hash-link" href="#14-scheduler" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="141-ensure-that-the---profiling-argument-is-set-to-false-scored"></a>1.4.1 Ensure that the <code>--profiling</code> argument is set to <code>false</code> (Scored)<a class="hash-link" href="#141-ensure-that-the---profiling-argument-is-set-to-false-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Scheduler pod specification file <code>/etc/kubernetes/manifests/kube-scheduler.yaml</code> file
on the master node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--profiling</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-scheduler | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;false&#x27; is equal to &#x27;false&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="142-ensure-that-the---bind-address-argument-is-set-to-127001-scored"></a>1.4.2 Ensure that the <code>--bind-address</code> argument is set to <code>127.0.0.1</code> (Scored)<a class="hash-link" href="#142-ensure-that-the---bind-address-argument-is-set-to-127001-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the Scheduler pod specification file <code>/etc/kubernetes/manifests/kube-scheduler.yaml</code>
on the master node and ensure the correct value for the <code>--bind-address</code> parameter.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | grep kube-scheduler | grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--bind-address&#x27; is present OR &#x27;--bind-address&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="2-etcd-node-configuration"></a>2 Etcd Node Configuration<a class="hash-link" href="#2-etcd-node-configuration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="2-etcd-node-configuration-files"></a>2 Etcd Node Configuration Files<a class="hash-link" href="#2-etcd-node-configuration-files" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="21-ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-scored"></a>2.1 Ensure that the <code>--cert-file</code> and <code>--key-file</code> arguments are set as appropriate (Scored)<a class="hash-link" href="#21-ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the etcd service documentation and configure TLS encryption.
Then, edit the etcd pod specification file <code>/etc/kubernetes/manifests/etcd.yaml</code>
on the master node and set the below parameters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--cert-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/path/to/ca-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">--key-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/path/to/key-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep etcd | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--cert-file&#x27; is present AND &#x27;--key-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="22-ensure-that-the---client-cert-auth-argument-is-set-to-true-scored"></a>2.2 Ensure that the <code>--client-cert-auth</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#22-ensure-that-the---client-cert-auth-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the etcd pod specification file <code>/etc/kubernetes/manifests/etcd.yaml</code> on the master
node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--client-cert-auth</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep etcd | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is equal to &#x27;true&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="23-ensure-that-the---auto-tls-argument-is-not-set-to-true-scored"></a>2.3 Ensure that the <code>--auto-tls</code> argument is not set to <code>true</code> (Scored)<a class="hash-link" href="#23-ensure-that-the---auto-tls-argument-is-not-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the etcd pod specification file <code>/etc/kubernetes/manifests/etcd.yaml</code> on the master
node and either remove the <code>--auto-tls</code> parameter or set it to <code>false</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> --auto-tls</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep etcd | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--auto-tls&#x27; is not present OR &#x27;--auto-tls&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="24-ensure-that-the---peer-cert-file-and---peer-key-file-arguments-are-set-as-appropriate-scored"></a>2.4 Ensure that the <code>--peer-cert-file</code> and <code>--peer-key-file</code> arguments are set as appropriate (Scored)<a class="hash-link" href="#24-ensure-that-the---peer-cert-file-and---peer-key-file-arguments-are-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the etcd service documentation and configure peer TLS encryption as appropriate
for your etcd cluster. Then, edit the etcd pod specification file <code>/etc/kubernetes/manifests/etcd.yaml</code> on the
master node and set the below parameters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--peer-client-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/path/to/peer-cert-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">--peer-key-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/path/to/peer-key-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep etcd | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--peer-cert-file&#x27; is present AND &#x27;--peer-key-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="25-ensure-that-the---peer-client-cert-auth-argument-is-set-to-true-scored"></a>2.5 Ensure that the <code>--peer-client-cert-auth</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#25-ensure-that-the---peer-client-cert-auth-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the etcd pod specification file <code>/etc/kubernetes/manifests/etcd.yaml</code> on the master
node and set the below parameter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--peer-client-cert-auth</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep etcd | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is equal to &#x27;true&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="26-ensure-that-the---peer-auto-tls-argument-is-not-set-to-true-scored"></a>2.6 Ensure that the <code>--peer-auto-tls</code> argument is not set to <code>true</code> (Scored)<a class="hash-link" href="#26-ensure-that-the---peer-auto-tls-argument-is-not-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the etcd pod specification file <code>/etc/kubernetes/manifests/etcd.yaml</code> on the master
node and either remove the <code>--peer-auto-tls</code> parameter or set it to <code>false</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--peer-auto-tls</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep etcd | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--peer-auto-tls&#x27; is not present OR &#x27;--peer-auto-tls&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="3-control-plane-configuration"></a>3 Control Plane Configuration<a class="hash-link" href="#3-control-plane-configuration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="32-logging"></a>3.2 Logging<a class="hash-link" href="#32-logging" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="321-ensure-that-a-minimal-audit-policy-is-created-scored"></a>3.2.1 Ensure that a minimal audit policy is created (Scored)<a class="hash-link" href="#321-ensure-that-a-minimal-audit-policy-is-created-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Create an audit policy file for your cluster.</p><p><strong>Audit Script:</strong> 3.2.1.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">api_server_bin=${1}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -ef | /bin/grep ${api_server_bin} | /bin/grep -v ${0} | /bin/grep -v grep</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./3.2.1.sh kube-apiserver</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--audit-policy-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="4-worker-node-security-configuration"></a>4 Worker Node Security Configuration<a class="hash-link" href="#4-worker-node-security-configuration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="41-worker-node-configuration-files"></a>4.1 Worker Node Configuration Files<a class="hash-link" href="#41-worker-node-configuration-files" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="411-ensure-that-the-kubelet-service-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>4.1.1 Ensure that the kubelet service file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#411-ensure-that-the-kubelet-service-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="412-ensure-that-the-kubelet-service-file-ownership-is-set-to-rootroot-scored"></a>4.1.2 Ensure that the kubelet service file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#412-ensure-that-the-kubelet-service-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="413-ensure-that-the-proxy-kubeconfig-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>4.1.3 Ensure that the proxy kubeconfig file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#413-ensure-that-the-proxy-kubeconfig-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the each worker node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">644</span><span class="token plain"> /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh -c &#x27;if test -e /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml; then stat -c %a /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml; fi&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;644&#x27; is present OR &#x27;640&#x27; is present OR &#x27;600&#x27; is equal to &#x27;600&#x27; OR &#x27;444&#x27; is present OR &#x27;440&#x27; is present OR &#x27;400&#x27; is present OR &#x27;000&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="414-ensure-that-the-proxy-kubeconfig-file-ownership-is-set-to-rootroot-scored"></a>4.1.4 Ensure that the proxy kubeconfig file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#414-ensure-that-the-proxy-kubeconfig-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the each worker node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> root:root /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh -c &#x27;if test -e /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml; then stat -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml; fi&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;root:root&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="415-ensure-that-the-kubeletconf-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>4.1.5 Ensure that the kubelet.conf file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#415-ensure-that-the-kubeletconf-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the each worker node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">644</span><span class="token plain"> /etc/kubernetes/ssl/kubecfg-kube-node.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh -c &#x27;if test -e /etc/kubernetes/ssl/kubecfg-kube-node.yaml; then stat -c %a /etc/kubernetes/ssl/kubecfg-kube-node.yaml; fi&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;644&#x27; is present OR &#x27;640&#x27; is present OR &#x27;600&#x27; is equal to &#x27;600&#x27; OR &#x27;444&#x27; is present OR &#x27;440&#x27; is present OR &#x27;400&#x27; is present OR &#x27;000&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="416-ensure-that-the-kubeletconf-file-ownership-is-set-to-rootroot-scored"></a>4.1.6 Ensure that the kubelet.conf file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#416-ensure-that-the-kubeletconf-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the below command (based on the file location on your system) on the each worker node.
For example,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> root:root /etc/kubernetes/ssl/kubecfg-kube-node.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh -c &#x27;if test -e /etc/kubernetes/ssl/kubecfg-kube-node.yaml; then stat -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-node.yaml; fi&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;root:root&#x27; is equal to &#x27;root:root&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="417-ensure-that-the-certificate-authorities-file-permissions-are-set-to-644-or-more-restrictive-scored"></a>4.1.7 Ensure that the certificate authorities file permissions are set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#417-ensure-that-the-certificate-authorities-file-permissions-are-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the following command to modify the file permissions of the</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--client-ca-file </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">644</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">stat -c %a /etc/kubernetes/ssl/kube-ca.pem</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;644&#x27; is equal to &#x27;644&#x27; OR &#x27;640&#x27; is present OR &#x27;600&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="418-ensure-that-the-client-certificate-authorities-file-ownership-is-set-to-rootroot-scored"></a>4.1.8 Ensure that the client certificate authorities file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#418-ensure-that-the-client-certificate-authorities-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Run the following command to modify the ownership of the <code>--client-ca-file</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> root:root </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh -c &#x27;if test -e /etc/kubernetes/ssl/kube-ca.pem; then stat -c %U:%G /etc/kubernetes/ssl/kube-ca.pem; fi&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;root:root&#x27; is equal to &#x27;root:root&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="419-ensure-that-the-kubelet-configuration-file-has-permissions-set-to-644-or-more-restrictive-scored"></a>4.1.9 Ensure that the kubelet configuration file has permissions set to <code>644</code> or more restrictive (Scored)<a class="hash-link" href="#419-ensure-that-the-kubelet-configuration-file-has-permissions-set-to-644-or-more-restrictive-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="4110-ensure-that-the-kubelet-configuration-file-ownership-is-set-to-rootroot-scored"></a>4.1.10 Ensure that the kubelet configuration file ownership is set to <code>root:root</code> (Scored)<a class="hash-link" href="#4110-ensure-that-the-kubelet-configuration-file-ownership-is-set-to-rootroot-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="42-kubelet"></a>4.2 Kubelet<a class="hash-link" href="#42-kubelet" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="421-ensure-that-the---anonymous-auth-argument-is-set-to-false-scored"></a>4.2.1 Ensure that the <code>--anonymous-auth argument</code> is set to false (Scored)<a class="hash-link" href="#421-ensure-that-the---anonymous-auth-argument-is-set-to-false-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set authentication: <code>anonymous</code>: enabled to
<code>false</code>.
If using executable arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
set the below parameter in <code>KUBELET_SYSTEM_PODS_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--anonymous-auth</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;false&#x27; is equal to &#x27;false&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="422-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored"></a>4.2.2 Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)<a class="hash-link" href="#422-ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set authorization: <code>mode</code> to <code>Webhook</code>. If
using executable arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
set the below parameter in <code>KUBELET_AUTHZ_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--authorization-mode</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Webhook</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;Webhook&#x27; not have &#x27;AlwaysAllow&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="423-ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored"></a>4.2.3 Ensure that the <code>--client-ca-file</code> argument is set as appropriate (Scored)<a class="hash-link" href="#423-ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set authentication: <code>x509</code>: <code>clientCAFile</code> to
the location of the client CA file.
If using command line arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
set the below parameter in <code>KUBELET_AUTHZ_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--client-ca-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to/client-ca-file</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--client-ca-file&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="424-ensure-that-the---read-only-port-argument-is-set-to-0-scored"></a>4.2.4 Ensure that the <code>--read-only-port</code> argument is set to <code>0</code> (Scored)<a class="hash-link" href="#424-ensure-that-the---read-only-port-argument-is-set-to-0-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set <code>readOnlyPort</code> to <code>0</code>.
If using command line arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
set the below parameter in <code>KUBELET_SYSTEM_PODS_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--read-only-port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0&#x27; is equal to &#x27;0&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="425-ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-scored"></a>4.2.5 Ensure that the <code>--streaming-connection-idle-timeout</code> argument is not set to <code>0</code> (Scored)<a class="hash-link" href="#425-ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set <code>streamingConnectionIdleTimeout</code> to a
value other than <code>0</code>.
If using command line arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
set the below parameter in <code>KUBELET_SYSTEM_PODS_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--streaming-connection-idle-timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">5m</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;30m&#x27; is not equal to &#x27;0&#x27; OR &#x27;--streaming-connection-idle-timeout&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="426-ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-scored"></a>4.2.6 Ensure that the <code>--protect-kernel-defaults</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#426-ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set <code>protectKernelDefaults</code>: <code>true</code>.
If using command line arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
set the below parameter in <code>KUBELET_SYSTEM_PODS_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--protect-kernel-defaults</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is equal to &#x27;true&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="427-ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-scored"></a>4.2.7 Ensure that the <code>--make-iptables-util-chains</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#427-ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to set <code>makeIPTablesUtilChains</code>: <code>true</code>.
If using command line arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
remove the <code>--make-iptables-util-chains</code> argument from the
<code>KUBELET_SYSTEM_PODS_ARGS</code> variable.
Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is equal to &#x27;true&#x27; OR &#x27;--make-iptables-util-chains&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="4210-ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored"></a>4.2.10 Ensure that the <code>--tls-cert-file</code> and <code>--tls-private-key-file</code> arguments are set as appropriate (Scored)<a class="hash-link" href="#4210-ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> Not Applicable</p><p><strong>Remediation:</strong>
RKE doesnâ€™t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="4211-ensure-that-the---rotate-certificates-argument-is-not-set-to-false-scored"></a>4.2.11 Ensure that the <code>--rotate-certificates</code> argument is not set to <code>false</code> (Scored)<a class="hash-link" href="#4211-ensure-that-the---rotate-certificates-argument-is-not-set-to-false-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
If using a Kubelet config file, edit the file to add the line <code>rotateCertificates</code>: <code>true</code> or
remove it altogether to use the default value.
If using command line arguments, edit the kubelet service file
<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> on each worker node and
remove <code>--rotate-certificates=false</code> argument from the <code>KUBELET_CERTIFICATE_ARGS</code>
variable.
Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--rotate-certificates&#x27; is present OR &#x27;--rotate-certificates&#x27; is not present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="4212-ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored"></a>4.2.12 Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to <code>true</code> (Scored)<a class="hash-link" href="#4212-ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Edit the kubelet service file <code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code>
on each worker node and set the below parameter in <code>KUBELET_CERTIFICATE_ARGS</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">--feature-gates</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">RotateKubeletServerCertificate</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on your system, restart the kubelet service. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kubelet.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/ps -fC kubelet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Config:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cat /var/lib/kubelet/config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;true&#x27; is equal to &#x27;true&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="5-kubernetes-policies"></a>5 Kubernetes Policies<a class="hash-link" href="#5-kubernetes-policies" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="51-rbac-and-service-accounts"></a>5.1 RBAC and Service Accounts<a class="hash-link" href="#51-rbac-and-service-accounts" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="515-ensure-that-default-service-accounts-are-not-actively-used-scored"></a>5.1.5 Ensure that default service accounts are not actively used. (Scored)<a class="hash-link" href="#515-ensure-that-default-service-accounts-are-not-actively-used-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Create explicit service accounts wherever a Kubernetes workload requires specific access
to the Kubernetes API server.
Modify the configuration of each default service account to include this value</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">automountServiceAccountToken: </span><span class="token boolean" style="color:#36acaa">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Script:</strong> 5.1.5.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=${KUBECONFIG:-/root/.kube/config}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl version \&gt; /dev/null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ $? -ne 0 ]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;fail: kubectl failed&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">accounts=&quot;$(kubectl --kubeconfig=${KUBECONFIG} get serviceaccounts -A -o json | jq -r &#x27;.items[] | select(.metadata.name==&quot;default&quot;) | select((.automountServiceAccountToken == null) or (.automountServiceAccountToken == true)) | &quot;fail \(.metadata.name) \(.metadata.namespace)&quot;&#x27;)&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ &quot;${accounts}&quot; != &quot;&quot; ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;fail: automountServiceAccountToken not false for accounts: ${accounts}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">default_binding=&quot;$(kubectl get rolebindings,clusterrolebindings -A -o json | jq -r &#x27;.items[] | select(.subjects[].kind==&quot;ServiceAccount&quot; and .subjects[].name==&quot;default&quot; and .metadata.name==&quot;default&quot;).metadata.uid&#x27; | wc -l)&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ &quot;${default_binding}&quot; -gt 0 ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;fail: default service accounts have non default bindings&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;--pass&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">exit 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./5.1.5.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;--pass&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="52-pod-security-policies"></a>5.2 Pod Security Policies<a class="hash-link" href="#52-pod-security-policies" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="522-minimize-the-admission-of-containers-wishing-to-share-the-host-process-id-namespace-scored"></a>5.2.2 Minimize the admission of containers wishing to share the host process ID namespace (Scored)<a class="hash-link" href="#522-minimize-the-admission-of-containers-wishing-to-share-the-host-process-id-namespace-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Create a PSP as described in the Kubernetes documentation, ensuring that the
<code>.spec.hostPID</code> field is omitted or set to <code>false</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --kubeconfig=/root/.kube/config get psp -o json | jq .items[] | jq -r &#x27;select((.spec.hostPID == null) or (.spec.hostPID == false))&#x27; | jq .metadata.name | wc -l | xargs -I {} echo &#x27;--count={}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">1 is greater than 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="523-minimize-the-admission-of-containers-wishing-to-share-the-host-ipc-namespace-scored"></a>5.2.3 Minimize the admission of containers wishing to share the host IPC namespace (Scored)<a class="hash-link" href="#523-minimize-the-admission-of-containers-wishing-to-share-the-host-ipc-namespace-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Create a PSP as described in the Kubernetes documentation, ensuring that the
<code>.spec.hostIPC</code> field is omitted or set to <code>false</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --kubeconfig=/root/.kube/config get psp -o json | jq .items[] | jq -r &#x27;select((.spec.hostIPC == null) or (.spec.hostIPC == false))&#x27; | jq .metadata.name | wc -l | xargs -I {} echo &#x27;--count={}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">1 is greater than 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="524-minimize-the-admission-of-containers-wishing-to-share-the-host-network-namespace-scored"></a>5.2.4 Minimize the admission of containers wishing to share the host network namespace (Scored)<a class="hash-link" href="#524-minimize-the-admission-of-containers-wishing-to-share-the-host-network-namespace-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Create a PSP as described in the Kubernetes documentation, ensuring that the
<code>.spec.hostNetwork</code> field is omitted or set to <code>false</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --kubeconfig=/root/.kube/config get psp -o json | jq .items[] | jq -r &#x27;select((.spec.hostNetwork == null) or (.spec.hostNetwork == false))&#x27; | jq .metadata.name | wc -l | xargs -I {} echo &#x27;--count={}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">1 is greater than 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="525-minimize-the-admission-of-containers-with-allowprivilegeescalation-scored"></a>5.2.5 Minimize the admission of containers with <code>allowPrivilegeEscalation</code> (Scored)<a class="hash-link" href="#525-minimize-the-admission-of-containers-with-allowprivilegeescalation-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Create a PSP as described in the Kubernetes documentation, ensuring that the
<code>.spec.allowPrivilegeEscalation</code> field is omitted or set to <code>false</code>.</p><p><strong>Audit:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --kubeconfig=/root/.kube/config get psp -o json | jq .items[] | jq -r &#x27;select((.spec.allowPrivilegeEscalation == null) or (.spec.allowPrivilegeEscalation == false))&#x27; | jq .metadata.name | wc -l | xargs -I {} echo &#x27;--count={}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">1 is greater than 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="53-network-policies-and-cni"></a>5.3 Network Policies and CNI<a class="hash-link" href="#53-network-policies-and-cni" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="532-ensure-that-all-namespaces-have-network-policies-defined-scored"></a>5.3.2 Ensure that all Namespaces have Network Policies defined (Scored)<a class="hash-link" href="#532-ensure-that-all-namespaces-have-network-policies-defined-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Follow the documentation and create <code>NetworkPolicy</code> objects as you need them.</p><p><strong>Audit Script:</strong> 5.3.2.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=${KUBECONFIG:-&quot;/root/.kube/config&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl version \&gt; /dev/null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ $? -ne 0 ]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;fail: kubectl failed&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">for namespace in $(kubectl get namespaces -A -o json | jq -r &#x27;.items[].metadata.name&#x27;); do</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  policy_count=$(kubectl get networkpolicy -n ${namespace} -o json | jq &#x27;.items | length&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if [ ${policy_count} -eq 0 ]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;fail: ${namespace}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;pass&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./5.3.2.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;pass&#x27; is present</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="56-general-policies"></a>5.6 General Policies<a class="hash-link" href="#56-general-policies" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="564-the-default-namespace-should-not-be-used-scored"></a>5.6.4 The default namespace should not be used (Scored)<a class="hash-link" href="#564-the-default-namespace-should-not-be-used-scored" title="Direct link to heading">#</a></h4><p><strong>Result:</strong> PASS</p><p><strong>Remediation:</strong>
Ensure that namespaces are created to allow for appropriate segregation of Kubernetes
resources and that all new resources are created in a specific namespace.</p><p><strong>Audit Script:</strong> 5.6.4.sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash -e</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=${KUBECONFIG:-/root/.kube/config}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl version \&gt; /dev/null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ $? -gt 0 ]]; then</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;fail: kubectl failed&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">default_resources=$(kubectl get all -o json | jq --compact-output &#x27;.items[] | select((.kind == &quot;Service&quot;) and (.metadata.name == &quot;kubernetes&quot;) and (.metadata.namespace == &quot;default&quot;) | not)&#x27; | wc -l)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;--count=${default_resources}&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Audit Execution:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./5.6.4.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Expected result</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0&#x27; is equal to &#x27;0&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/versioned_docs/version-2.5.9/security/rancher-2.5/1.5-benchmark-2.5.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rancher-docusaurus/2.5.9/security/index"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Intro</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rancher-docusaurus/2.5.9/security/rancher-2.5/1.5-hardening-2.5"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Hardening Guide with CIS 1.5 Benchmark Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cis-v15-kubernetes-benchmark---rancher-v25-with-kubernetes-v115" class="table-of-contents__link">CIS v1.5 Kubernetes Benchmark - Rancher v2.5 with Kubernetes v1.15</a></li><li><a href="#controls" class="table-of-contents__link">Controls</a></li><li><a href="#1-master-node-security-configuration" class="table-of-contents__link">1 Master Node Security Configuration</a><ul><li><a href="#11-master-node-configuration-files" class="table-of-contents__link">1.1 Master Node Configuration Files</a></li><li><a href="#12-api-server" class="table-of-contents__link">1.2 API Server</a></li><li><a href="#13-controller-manager" class="table-of-contents__link">1.3 Controller Manager</a></li><li><a href="#14-scheduler" class="table-of-contents__link">1.4 Scheduler</a></li></ul></li><li><a href="#2-etcd-node-configuration" class="table-of-contents__link">2 Etcd Node Configuration</a><ul><li><a href="#2-etcd-node-configuration-files" class="table-of-contents__link">2 Etcd Node Configuration Files</a></li></ul></li><li><a href="#3-control-plane-configuration" class="table-of-contents__link">3 Control Plane Configuration</a><ul><li><a href="#32-logging" class="table-of-contents__link">3.2 Logging</a></li></ul></li><li><a href="#4-worker-node-security-configuration" class="table-of-contents__link">4 Worker Node Security Configuration</a><ul><li><a href="#41-worker-node-configuration-files" class="table-of-contents__link">4.1 Worker Node Configuration Files</a></li><li><a href="#42-kubelet" class="table-of-contents__link">4.2 Kubelet</a></li></ul></li><li><a href="#5-kubernetes-policies" class="table-of-contents__link">5 Kubernetes Policies</a><ul><li><a href="#51-rbac-and-service-accounts" class="table-of-contents__link">5.1 RBAC and Service Accounts</a></li><li><a href="#52-pod-security-policies" class="table-of-contents__link">5.2 Pod Security Policies</a></li><li><a href="#53-network-policies-and-cni" class="table-of-contents__link">5.3 Network Policies and CNI</a></li><li><a href="#56-general-policies" class="table-of-contents__link">5.6 General Policies</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://forums.rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://slack.rancher.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/Rancher_Labs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher Website</a></li><li class="footer__item"><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/rancher/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher Docs on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/rancher-docusaurus/assets/js/runtime~main.e49194ca.js"></script>
<script src="/rancher-docusaurus/assets/js/main.ed945e9c.js"></script>
</body>
</html>