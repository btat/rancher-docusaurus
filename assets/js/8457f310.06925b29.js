"use strict";(self.webpackChunkrancher_docusaurus=self.webpackChunkrancher_docusaurus||[]).push([[71493],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return p}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),u=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=u(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),h=u(n),p=a,m=h["".concat(c,".").concat(p)]||h[p]||d[p]||o;return n?r.createElement(m,i(i({ref:t},l),{},{components:n})):r.createElement(m,i({ref:t},l))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},48777:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return u},toc:function(){return l},default:function(){return h}});var r=n(87462),a=n(63366),o=(n(67294),n(3905)),i=["components"],s={title:"Tips for Running Rancher",position:100},c=void 0,u={unversionedId:"best-practices/rancher-server/deployment-types",id:"version-2.5.9/best-practices/rancher-server/deployment-types",isDocsHomePage:!1,title:"Tips for Running Rancher",description:"This guide is geared toward use cases where Rancher is used to manage downstream Kubernetes clusters. The high-availability setup is intended to prevent losing access to downstream clusters if the Rancher server is not available.",source:"@site/versioned_docs/version-2.5.9/best-practices/rancher-server/deployment-types.md",sourceDirName:"best-practices/rancher-server",slug:"/best-practices/rancher-server/deployment-types",permalink:"/rancher-docusaurus/2.5.9/best-practices/rancher-server/deployment-types",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/versioned_docs/version-2.5.9/best-practices/rancher-server/deployment-types.md",tags:[],version:"2.5.9",frontMatter:{title:"Tips for Running Rancher",position:100},sidebar:"version-2.5.9/tutorialSidebar",previous:{title:"Rancher Deployment Strategy",permalink:"/rancher-docusaurus/2.5.9/best-practices/rancher-server/deployment-strategies"},next:{title:"Best Practices for the Rancher Server",permalink:"/rancher-docusaurus/2.5.9/best-practices/rancher-server/index"}},l=[{value:"Run Rancher on a Separate Cluster",id:"run-rancher-on-a-separate-cluster",children:[]},{value:"Make sure nodes are configured correctly for Kubernetes",id:"make-sure-nodes-are-configured-correctly-for-kubernetes",children:[]},{value:"When using RKE: Back up the Statefile",id:"when-using-rke-back-up-the-statefile",children:[]},{value:"Run All Nodes in the Cluster in the Same Datacenter",id:"run-all-nodes-in-the-cluster-in-the-same-datacenter",children:[]},{value:"Development and Production Environments Should be Similar",id:"development-and-production-environments-should-be-similar",children:[]},{value:"Monitor Your Clusters to Plan Capacity",id:"monitor-your-clusters-to-plan-capacity",children:[]}],d={toc:l};function h(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This guide is geared toward use cases where Rancher is used to manage downstream Kubernetes clusters. The high-availability setup is intended to prevent losing access to downstream clusters if the Rancher server is not available."),(0,o.kt)("p",null,'A high-availability Kubernetes installation, defined as an installation of Rancher on a Kubernetes cluster with at least three nodes, should be used in any production installation of Rancher, as well as any installation deemed "important." Multiple Rancher instances running on multiple nodes ensure high availability that cannot be accomplished with a single node environment.'),(0,o.kt)("p",null,"If you are installing Rancher in a vSphere environment, refer to the best practices documented ",(0,o.kt)("a",{parentName:"p",href:"../rancher-in-vsphere"},"here.")),(0,o.kt)("p",null,"When you set up your high-availability Rancher installation, consider the following:"),(0,o.kt)("h3",{id:"run-rancher-on-a-separate-cluster"},"Run Rancher on a Separate Cluster"),(0,o.kt)("p",null,"Don't run other workloads or microservices in the Kubernetes cluster that Rancher is installed on."),(0,o.kt)("h3",{id:"make-sure-nodes-are-configured-correctly-for-kubernetes"},"Make sure nodes are configured correctly for Kubernetes"),(0,o.kt)("p",null,"It's important to follow K8s and etcd best practices when deploying your nodes, including disabling swap, double checking you have full network connectivity between all machines in the cluster, using unique hostnames, MAC addresses, and product_uuids for every node, checking that all correct ports are opened, and deploying with ssd backed etcd.  More details can be found in the ",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#before-you-begin"},"kubernetes docs")," and ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/performance.md"},"etcd's performance op guide")),(0,o.kt)("h3",{id:"when-using-rke-back-up-the-statefile"},"When using RKE: Back up the Statefile"),(0,o.kt)("p",null,"RKE keeps record of the cluster state in a file called ",(0,o.kt)("inlineCode",{parentName:"p"},"cluster.rkestate"),". This file is important for the recovery of a cluster and/or the continued maintenance of the cluster through RKE. Because this file contains certificate material, we strongly recommend encrypting this file before backing up. After each run of ",(0,o.kt)("inlineCode",{parentName:"p"},"rke up")," you should backup the state file. "),(0,o.kt)("h3",{id:"run-all-nodes-in-the-cluster-in-the-same-datacenter"},"Run All Nodes in the Cluster in the Same Datacenter"),(0,o.kt)("p",null,"For best performance, run all three of your nodes in the same geographic datacenter. If you are running nodes in the cloud, such as AWS, run each node in a separate Availability Zone. For example, launch node 1 in us-west-2a, node 2 in us-west-2b, and node 3 in us-west-2c."),(0,o.kt)("h3",{id:"development-and-production-environments-should-be-similar"},"Development and Production Environments Should be Similar"),(0,o.kt)("p",null,'It\'s strongly recommended to have a "staging" or "pre-production" environment of the Kubernetes cluster that Rancher runs on. This environment should mirror your production environment as closely as possible in terms of software and hardware configuration.'),(0,o.kt)("h3",{id:"monitor-your-clusters-to-plan-capacity"},"Monitor Your Clusters to Plan Capacity"),(0,o.kt)("p",null,"The Rancher server's Kubernetes cluster should run within the ",(0,o.kt)("a",{parentName:"p",href:"https://rancher.com/docs/rancher/v2.6/en/installation/requirements/"},"system and hardware requirements")," as closely as possible. The more you deviate from the system and hardware requirements, the more risk you take."),(0,o.kt)("p",null,"However, metrics-driven capacity planning analysis should be the ultimate guidance for scaling Rancher, because the published requirements take into account a variety of workload types."),(0,o.kt)("p",null,"Using Rancher, you can monitor the state and processes of your cluster nodes, Kubernetes components, and software deployments through integration with Prometheus, a leading open-source monitoring solution, and Grafana, which lets you visualize the metrics from Prometheus. "),(0,o.kt)("p",null,"After you ",(0,o.kt)("a",{parentName:"p",href:"https://rancher.com/docs/rancher/v2.6/en/monitoring-alerting"},"enable monitoring")," in the cluster, you can set up alerts to let you know if your cluster is approaching its capacity. You can also use the Prometheus and Grafana monitoring framework to establish a baseline for key metrics as you scale."))}h.isMDXComponent=!0}}]);