<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Configuring Google OAuth | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://btat.github.io/rancher-docusaurus/admin-settings/authentication/google"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Configuring Google OAuth | My Site"><meta data-react-helmet="true" name="description" content="If your organization uses G Suite for user authentication, you can configure Rancher to allow your users to log in using their G Suite credentials."><meta data-react-helmet="true" property="og:description" content="If your organization uses G Suite for user authentication, you can configure Rancher to allow your users to log in using their G Suite credentials."><link data-react-helmet="true" rel="shortcut icon" href="/rancher-docusaurus/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://btat.github.io/rancher-docusaurus/admin-settings/authentication/google"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/admin-settings/authentication/google" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/admin-settings/authentication/google" hreflang="x-default"><link rel="stylesheet" href="/rancher-docusaurus/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/rancher-docusaurus/assets/js/runtime~main.9668cced.js" as="script">
<link rel="preload" href="/rancher-docusaurus/assets/js/main.7243044c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rancher-docusaurus/"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Rancher Docs</b></a><a href="https://suse-projects.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>More SUSE Projects<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Rancher Deployment Quick Start Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installing/Upgrading Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Best Practices Guide</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Backups and Disaster Recovery</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Authentication, Permissions and Global Configuration</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">authentication</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/ad">Configuring Active Directory (AD)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/azure-ad">Configuring Azure AD</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/freeipa">Configuring FreeIPA</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/github">Configuring GitHub</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/google">Configuring Google OAuth</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/index">Authentication</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/keycloak-oidc">Configuring Keycloak (OIDC)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/keycloak-saml">Configuring Keycloak (SAML)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/local">Local Authentication</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">microsoft-adfs</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/okta">Configuring Okta (SAML)</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">openldap</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/ping-federate">Configuring PingIdentity (SAML)</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">shibboleth</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/authentication/user-groups">Users and Groups</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/branding">Custom Branding</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/cluster-templates">Cluster Templates</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/config-private-registry">Configuring a Global Default Private Registry</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">drivers</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/index">Intro</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/k8s-metadata">Upgrading Kubernetes without Upgrading Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/admin-settings/pod-security-policies">Pod Security Policies</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">rbac</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">rke-templates</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Setting up Kubernetes Clusters in Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cluster Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Project Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pipelines</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deploying Applications across Clusters</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Monitoring and Alerting</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Istio</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Logging</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CIS Scans</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes Resources</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Settings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FAQ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/cli">Using the Rancher Command Line Interface</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/contributing">Contributing to Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/helm-charts">Helm Charts in Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/">Rancher 2.6</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/longhorn">Longhorn - Cloud native distributed block storage for Kubernetes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/opa-gatekeper">OPA Gatekeeper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/system-tools">System Tools</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Configuring Google OAuth</h1></header><p>If your organization uses G Suite for user authentication, you can configure Rancher to allow your users to log in using their G Suite credentials.</p><p>Only admins of the G Suite domain have access to the Admin SDK. Therefore, only G Suite admins can configure Google OAuth for Rancher.</p><p>Within Rancher, only administrators or users with the <strong>Manage Authentication</strong> <a href="https://rancher.com/docs/rancher/v2.6/en/admin-settings/rbac/global-permissions/" target="_blank" rel="noopener noreferrer">global role</a> can configure authentication.</p><header><h1>Prerequisites</h1></header><ul><li>You must have a <a href="https://admin.google.com" target="_blank" rel="noopener noreferrer">G Suite admin account</a> configured.</li><li>G Suite requires a <a href="https://github.com/google/guava/wiki/InternetDomainNameExplained#public-suffixes-and-private-domains" target="_blank" rel="noopener noreferrer">top private domain FQDN</a> as an authorized domain. One way to get an FQDN is by creating an A-record in Route53 for your Rancher server. You do not need to update your Rancher Server URL setting with that record, because there could be clusters using that URL.</li><li>You must have the Admin SDK API enabled for your G Suite domain. You can enable it using the steps on <a href="https://support.google.com/a/answer/60757?hl=en" target="_blank" rel="noopener noreferrer">this page.</a></li></ul><p>After the Admin SDK API is enabled, your G Suite domain&#x27;s API screen should look like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">![Enable Admin APIs](./assets/img/rancher/Google-Enable-APIs-Screen.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><header><h1>Setting up G Suite for OAuth with Rancher</h1></header><p>Before you can set up Google OAuth in Rancher, you need to log in to your G Suite account and do the following:</p><ol><li><a href="#1-adding-rancher-as-an-authorized-domain">Add Rancher as an authorized domain in G Suite</a></li><li><a href="#2-creating-oauth2-credentials-for-the-rancher-server">Generate OAuth2 credentials for the Rancher server</a></li><li><a href="#3-creating-service-account-credentials">Create service account credentials for the Rancher server</a></li><li><a href="#4-register-the-service-account-key-as-an-oauth-client">Register the service account key as an OAuth Client</a></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1-adding-rancher-as-an-authorized-domain"></a>1. Adding Rancher as an Authorized Domain<a class="hash-link" href="#1-adding-rancher-as-an-authorized-domain" title="Direct link to heading">#</a></h3><ol><li>Click <a href="https://console.developers.google.com/apis/credentials" target="_blank" rel="noopener noreferrer">here</a> to go to credentials page of your Google domain.</li><li>Select your project and click <strong>OAuth consent screen</strong>.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">![OAuth Consent Screen](./assets/img/rancher/Google-OAuth-consent-screen-tab.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li>Go to <strong>Authorized Domains</strong> and enter the top private domain of your Rancher server URL in the list. The top private domain is the rightmost superdomain. So for example, <a href="http://www.foo.co.uk" target="_blank" rel="noopener noreferrer">www.foo.co.uk</a> a top private domain of foo.co.uk. For more information on top-level domains, refer to <a href="https://github.com/google/guava/wiki/InternetDomainNameExplained#public-suffixes-and-private-domains" target="_blank" rel="noopener noreferrer">this article.</a></li><li>Go to <strong>Scopes for Google APIs</strong> and make sure <strong>email,</strong> <strong>profile</strong> and <strong>openid</strong> are enabled.</li></ol><p><strong>Result:</strong> Rancher has been added as an authorized domain for the Admin SDK API.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="2-creating-oauth2-credentials-for-the-rancher-server"></a>2. Creating OAuth2 Credentials for the Rancher Server<a class="hash-link" href="#2-creating-oauth2-credentials-for-the-rancher-server" title="Direct link to heading">#</a></h3><ol><li>Go to the Google API console, select your project, and go to the <a href="https://console.developers.google.com/apis/credentials" target="_blank" rel="noopener noreferrer">credentials page.</a></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">![Credentials](./assets/img/rancher/Google-Credentials-tab.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li>On the <strong>Create Credentials</strong> dropdown, select <strong>OAuth client ID</strong>.</li><li>Click <strong>Web application</strong>.</li><li>Provide a name.</li><li>Fill out the <strong>Authorized JavaScript origins</strong> and <strong>Authorized redirect URIs</strong>. Note: The Rancher UI page for setting up Google OAuth (available from the Global view under <strong>Security &gt; Authentication &gt; Google</strong>) provides you the exact links to enter for this step.</li></ol><ul><li>Under <strong>Authorized JavaScript origins,</strong> enter your Rancher server URL.</li><li>Under <strong>Authorized redirect URIs,</strong> enter your Rancher server URL appended with the path <code>verify-auth</code>. For example, if your URI is <code>https://rancherServer</code>, you will enter <code>https://rancherServer/verify-auth</code>.</li></ul><ol><li>Click on <strong>Create</strong>.</li><li>After the credential is created, you will see a screen with a list of your credentials. Choose the credential you just created, and in that row on rightmost side, click <strong>Download JSON</strong>. Save the file so that you can provide these credentials to Rancher.</li></ol><p><strong>Result:</strong> Your OAuth credentials have been successfully created.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="3-creating-service-account-credentials"></a>3. Creating Service Account Credentials<a class="hash-link" href="#3-creating-service-account-credentials" title="Direct link to heading">#</a></h3><p>Since the Google Admin SDK is available only to admins, regular users cannot use it to retrieve profiles of other users or their groups. Regular users cannot even retrieve their own groups.</p><p>Since Rancher provides group-based membership access, we require the users to be able to get their own groups, and look up other users and groups when needed.</p><p>As a workaround to get this capability, G Suite recommends creating a service account and delegating authority of your G Suite domain to that service account.</p><p>This section describes how to:</p><ul><li>Create a service account</li><li>Create a key for the service account and download the credentials as JSON</li></ul><ol><li>Click <a href="https://console.developers.google.com/iam-admin/serviceaccounts" target="_blank" rel="noopener noreferrer">here</a> and select your project for which you generated OAuth credentials.</li><li>Click on <strong>Create Service Account</strong>.</li><li>Enter a name and click <strong>Create</strong>.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">![Service account creation Step 1](./assets/img/rancher/Google-svc-acc-step1.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li>Don&#x27;t provide any roles on the <strong>Service account permissions</strong> page and click <strong>Continue</strong></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">![Service account creation Step 2](./assets/img/rancher/Google-svc-acc-step2.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li>Click on <strong>Create Key</strong> and select the JSON option. Download the JSON file and save it so that you can provide it as the service account credentials to Rancher.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">![Service account creation Step 3](./assets/img/rancher/Google-svc-acc-step3-key-creation.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Result:</strong> Your service account is created.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="4-register-the-service-account-key-as-an-oauth-client"></a>4. Register the Service Account Key as an OAuth Client<a class="hash-link" href="#4-register-the-service-account-key-as-an-oauth-client" title="Direct link to heading">#</a></h3><p>You will need to grant some permissions to the service account you created in the last step. Rancher requires you to grant only read-only permissions for users and groups.</p><p>Using the Unique ID of the service account key, register it as an Oauth Client using the following steps:</p><ol><li>Get the Unique ID of the key you just created. If it&#x27;s not displayed in the list of keys right next to the one you created, you will have to enable it. To enable it, click <strong>Unique ID</strong> and click <strong>OK</strong>. This will add a <strong>Unique ID</strong> column to the list of service account keys. Save the one listed for the service account you created. NOTE: This is a numeric key, not to be confused with the alphanumeric field <strong>Key ID</strong>.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">    ![Service account Unique ID](./assets/img/rancher/Google-Select-UniqueID-column.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li>Go to the <a href="https://admin.google.com/ac/owl/domainwidedelegation" target="_blank" rel="noopener noreferrer"><strong>Domain-wide Delegation</strong> page.</a></li><li>Add the Unique ID obtained in the previous step in the <strong>Client Name</strong> field.</li><li>In the <strong>One or More API Scopes</strong> field, add the following scopes:<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">openid,profile,email,https://www.googleapis.com/auth/admin.directory.user.readonly,https://www.googleapis.com/auth/admin.directory.group.readonly</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li>Click <strong>Authorize</strong>.</li></ol><p><strong>Result:</strong> The service account is registered as an OAuth client in your G Suite account.</p><header><h1>Configuring Google OAuth in Rancher</h1></header><ol><li>Sign into Rancher using a local user assigned the <a href="https://rancher.com/docs/rancher/v2.6/en/admin-settings/rbac/global-permissions" target="_blank" rel="noopener noreferrer">administrator</a> role. This user is also called the local principal.</li><li>In the top left corner, click <strong>â˜° &gt; Users &amp; Authentication</strong>.</li><li>In the left navigation menu, click <strong>Auth Provider</strong>.</li><li>Click <strong>Google</strong>. The instructions in the UI cover the steps to set up authentication with Google OAuth.<ol><li>Admin Email: Provide the email of an administrator account from your GSuite setup. In order to perform user and group lookups, google apis require an administrator&#x27;s email in conjunction with the service account key.</li><li>Domain: Provide the domain on which you have configured GSuite. Provide the exact domain and not any aliases.</li><li>Nested Group Membership: Check this box to enable nested group memberships. Rancher admins can disable this at any time after configuring auth.</li></ol><ul><li><strong>Step One</strong> is about adding Rancher as an authorized domain, which we already covered in <a href="#1-adding-rancher-as-an-authorized-domain">this section.</a></li><li>For <strong>Step Two,</strong> provide the OAuth credentials JSON that you downloaded after completing <a href="#2-creating-oauth2-credentials-for-the-rancher-server">this section.</a> You can upload the file or paste the contents into the <strong>OAuth Credentials</strong> field.</li><li>For <strong>Step Three,</strong> provide the service account credentials JSON that downloaded at the end of <a href="#3-creating-service-account-credentials">this section.</a> The credentials will only work if you successfully <a href="#4-register-the-service-account-key-as-an-oauth-client">registered the service account key</a> as an OAuth client in your G Suite account.</li></ul></li><li>Click <strong>Authenticate with Google</strong>.</li><li>Click <strong>Enable</strong>.</li></ol><p><strong>Result:</strong> Google authentication is successfully configured.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/admin-settings/authentication/google.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rancher-docusaurus/admin-settings/authentication/github"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Configuring GitHub</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rancher-docusaurus/admin-settings/authentication/index"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Authentication Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-adding-rancher-as-an-authorized-domain" class="table-of-contents__link">1. Adding Rancher as an Authorized Domain</a></li><li><a href="#2-creating-oauth2-credentials-for-the-rancher-server" class="table-of-contents__link">2. Creating OAuth2 Credentials for the Rancher Server</a></li><li><a href="#3-creating-service-account-credentials" class="table-of-contents__link">3. Creating Service Account Credentials</a></li><li><a href="#4-register-the-service-account-key-as-an-oauth-client" class="table-of-contents__link">4. Register the Service Account Key as an OAuth Client</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://forums.rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://slack.rancher.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/Rancher_Labs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher Website</a></li><li class="footer__item"><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/rancher/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher Docs on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/rancher-docusaurus/assets/js/runtime~main.9668cced.js"></script>
<script src="/rancher-docusaurus/assets/js/main.7243044c.js"></script>
</body>
</html>