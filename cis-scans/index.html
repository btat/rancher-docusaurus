<!doctype html>
<html class="docs-version-2.4.15" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Intro | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://btat.github.io/rancher-docusaurus/cis-scans/index"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.4.15"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.4.15"><meta data-react-helmet="true" property="og:title" content="Intro | My Site"><meta data-react-helmet="true" name="description" content="Rancher can run a security scan to check whether Kubernetes is deployed according to security best practices as defined in the CIS Kubernetes Benchmark. The CIS scans can run on any Kubernetes cluster, including hosted Kubernetes providers such as EKS, AKS, and GKE."><meta data-react-helmet="true" property="og:description" content="Rancher can run a security scan to check whether Kubernetes is deployed according to security best practices as defined in the CIS Kubernetes Benchmark. The CIS scans can run on any Kubernetes cluster, including hosted Kubernetes providers such as EKS, AKS, and GKE."><link data-react-helmet="true" rel="shortcut icon" href="/rancher-docusaurus/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://btat.github.io/rancher-docusaurus/cis-scans/index"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/cis-scans/index" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/cis-scans/index" hreflang="x-default"><link rel="stylesheet" href="/rancher-docusaurus/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/rancher-docusaurus/assets/js/runtime~main.e49194ca.js" as="script">
<link rel="preload" href="/rancher-docusaurus/assets/js/main.ed945e9c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rancher-docusaurus/"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Rancher Docs</b></a><a href="https://suse-projects.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>More SUSE Projects<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Rancher Deployment Quick Start Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installing/Upgrading Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Best Practices Guide</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Backups and Disaster Recovery</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Authentication, Permissions and Global Configuration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Setting up Kubernetes Clusters in Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cluster Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Project Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pipelines</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deploying Applications across Clusters</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Monitoring and Alerting</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Istio</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Logging</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">CIS Scans</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/cis-scans/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/cis-scans/custom-benchmark">Creating a Custom Benchmark Version for Running a Cluster Scan</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rancher-docusaurus/cis-scans/index">Intro</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/cis-scans/rbac">Roles-based Access Control</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/cis-scans/skipped-tests">Skipped and Not Applicable Tests</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes Resources</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Settings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FAQ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/cli">Using the Rancher Command Line Interface</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/contributing">Contributing to Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/helm-charts">Helm Charts in Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/">Rancher 2.6</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/longhorn">Longhorn - Cloud native distributed block storage for Kubernetes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/opa-gatekeper">OPA Gatekeeper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/system-tools">System Tools</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 2.4.15</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Intro</h1></header><p>Rancher can run a security scan to check whether Kubernetes is deployed according to security best practices as defined in the CIS Kubernetes Benchmark. The CIS scans can run on any Kubernetes cluster, including hosted Kubernetes providers such as EKS, AKS, and GKE.</p><p>The <code>rancher-cis-benchmark</code> app leverages \&lt;a href=&quot;<a href="https://github.com/aquasecurity/kube-bench%22" target="_blank" rel="noopener noreferrer">https://github.com/aquasecurity/kube-bench&quot;</a> target=&quot;_blank&quot;&gt;kube-bench,\&lt;/a&gt; an open-source tool from Aqua Security, to check clusters for CIS Kubernetes Benchmark compliance. Also, to generate a cluster-wide report, the application utilizes \&lt;a href=&quot;<a href="https://github.com/vmware-tanzu/sonobuoy%22" target="_blank" rel="noopener noreferrer">https://github.com/vmware-tanzu/sonobuoy&quot;</a> target=&quot;_blank&quot;&gt;Sonobuoy\&lt;/a&gt; for report aggregation.</p><header><h1>About the CIS Benchmark</h1></header><p>The Center for Internet Security is a 501(c)(3) non-profit organization, formed in October 2000, with a mission to &quot;identify, develop, validate, promote, and sustain best practice solutions for cyber defense and build and lead communities to enable an environment of trust in cyberspace&quot;. The organization is headquartered in East Greenbush, New York, with members including large corporations, government agencies, and academic institutions.</p><p>CIS Benchmarks are best practices for the secure configuration of a target system. CIS Benchmarks are developed through the generous volunteer efforts of subject matter experts, technology vendors, public and private community members, and the CIS Benchmark Development team.</p><p>The official Benchmark documents are available through the CIS website. The sign-up form to access the documents is
\&lt;a href=&quot;<a href="https://learn.cisecurity.org/benchmarks%22" target="_blank" rel="noopener noreferrer">https://learn.cisecurity.org/benchmarks&quot;</a> target=&quot;_blank&quot;&gt;here.\&lt;/a&gt;</p><header><h1>About the Generated Report</h1></header><p>Each scan generates a report can be viewed in the Rancher UI and can be downloaded in CSV format.</p><p>By default, the CIS Benchmark v1.6 is used.</p><p>The Benchmark version is included in the generated report.</p><p>The Benchmark provides recommendations of two types: Scored and Not Scored. Recommendations marked as Not Scored in the Benchmark are not included in the generated report.</p><p>Some tests are designated as &quot;Not Applicable.&quot; These tests will not be run on any CIS scan because of the way that Rancher provisions RKE clusters. For information on how test results can be audited, and why some tests are designated to be not applicable, refer to Rancher&#x27;s \&lt;a href=&quot;<a href="https://rancher.com/docs/rancher/v2.6/en/security/#the-cis-benchmark-and-self-assessment%22" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/rancher/v2.6/en/security/#the-cis-benchmark-and-self-assessment&quot;</a> target=&quot;_blank&quot;&gt;self-assessment guide for the corresponding Kubernetes version.\&lt;/a&gt;</p><p>The report contains the following information:</p><table><thead><tr><th>Column in Report</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>The ID number of the CIS Benchmark.</td></tr><tr><td><code>description</code></td><td>The description of the CIS Benchmark test.</td></tr><tr><td><code>remediation</code></td><td>What needs to be fixed in order to pass the test.</td></tr><tr><td><code>state</code></td><td>Indicates if the test passed, failed, was skipped, or was not applicable.</td></tr><tr><td><code>node_type</code></td><td>The node role, which affects which tests are run on the node. Master tests are run on controlplane nodes, etcd tests are run on etcd nodes, and node tests are run on the worker nodes.</td></tr><tr><td><code>audit</code></td><td>This is the audit check that <code>kube-bench</code> runs for this test.</td></tr><tr><td><code>audit_config</code></td><td>Any configuration applicable to the audit script.</td></tr><tr><td><code>test_info</code></td><td>Test-related info as reported by <code>kube-bench</code>, if any.</td></tr><tr><td><code>commands</code></td><td>Test-related commands as reported by <code>kube-bench</code>, if any.</td></tr><tr><td><code>config_commands</code></td><td>Test-related configuration data as reported by <code>kube-bench</code>, if any.</td></tr><tr><td><code>actual_value</code></td><td>The test&#x27;s actual value, present if reported by <code>kube-bench</code>.</td></tr><tr><td><code>expected_result</code></td><td>The test&#x27;s expected result, present if reported by <code>kube-bench</code>.</td></tr></tbody></table><p>Refer to \&lt;a href=&quot;<a href="https://rancher.com/docs/rancher/v2.6/en/security/%22" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/rancher/v2.6/en/security/&quot;</a> target=&quot;_blank&quot;&gt;the table in the cluster hardening guide\&lt;/a&gt; for information on which versions of Kubernetes, the Benchmark, Rancher, and our cluster hardening guide correspond to each other. Also refer to the hardening guide for configuration files of CIS-compliant clusters and information on remediating failed tests.</p><header><h1>Test Profiles</h1></header><p>The following profiles are available:</p><ul><li>Generic CIS 1.5</li><li>Generic CIS 1.6</li><li>RKE permissive 1.5</li><li>RKE hardened 1.5</li><li>RKE permissive 1.6</li><li>RKE hardened 1.6</li><li>EKS</li><li>GKE</li><li>RKE2 permissive 1.5</li><li>RKE2 permissive 1.5</li></ul><p>You also have the ability to customize a profile by saving a set of tests to skip.</p><p>All profiles will have a set of not applicable tests that will be skipped during the CIS scan. These tests are not applicable based on how a RKE cluster manages Kubernetes.</p><p>There are two types of RKE cluster scan profiles:</p><ul><li><strong>Permissive:</strong> This profile has a set of tests that have been will be skipped as these tests will fail on a default RKE Kubernetes cluster. Besides the list of skipped tests, the profile will also not run the not applicable tests.</li><li><strong>Hardened:</strong> This profile will not skip any tests, except for the non-applicable tests.</li></ul><p>The EKS and GKE cluster scan profiles are based on CIS Benchmark versions that are specific to those types of clusters.</p><p>In order to pass the &quot;Hardened&quot; profile, you will need to follow the steps on the \&lt;a href=&quot;<a href="https://rancher.com/docs/rancher/v2.6/en/security/#rancher-hardening-guide%22" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/rancher/v2.6/en/security/#rancher-hardening-guide&quot;</a> target=&quot;_blank&quot;&gt;hardening guide\&lt;/a&gt; and use the <code>cluster.yml</code> defined in the hardening guide to provision a hardened cluster.</p><p>The default profile and the supported CIS benchmark version depends on the type of cluster that will be scanned:</p><p>The <code>rancher-cis-benchmark</code> supports the CIS 1.6 Benchmark version.</p><ul><li>For RKE Kubernetes clusters, the RKE Permissive 1.6 profile is the default.</li><li>EKS and GKE have their own CIS Benchmarks published by <code>kube-bench</code>. The corresponding test profiles are used by default for those clusters.</li><li>For RKE2 Kubernetes clusters, the RKE2 Permissive 1.5 profile is the default.</li><li>For cluster types other than RKE, RKE2, EKS and GKE, the Generic CIS 1.5 profile will be used by default.</li></ul><header><h1>About Skipped and Not Applicable Tests</h1></header><p>For a list of skipped and not applicable tests, refer to \&lt;a href=&quot;<a href="https://rancher.com/docs/rancher/v2.6/en/cis-scans/skipped-tests%22" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/rancher/v2.6/en/cis-scans/skipped-tests&quot;</a> target=&quot;_blank&quot;&gt;this page.\&lt;/a&gt;</p><p>For now, only user-defined skipped tests are marked as skipped in the generated report.</p><p>Any skipped tests that are defined as being skipped by one of the default profiles are marked as not applicable.</p><header><h1>Roles-based Access Control</h1></header><p>For information about permissions, refer to \&lt;a href=&quot;<a href="https://rancher.com/docs/rancher/v2.6/en/cis-scans/rbac%22" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/rancher/v2.6/en/cis-scans/rbac&quot;</a> target=&quot;_blank&quot;&gt;this page.\&lt;/a&gt;</p><header><h1>Configuration</h1></header><p>For more information about configuring the custom resources for the scans, profiles, and benchmark versions, refer to \&lt;a href=&quot;<a href="https://rancher.com/docs/rancher/v2.6/en/cis-scans/configuration%22" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/rancher/v2.6/en/cis-scans/configuration&quot;</a> target=&quot;_blank&quot;&gt;this page.\&lt;/a&gt;</p><header><h1>How-to Guides</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="installing-cis-benchmark"></a>Installing CIS Benchmark<a class="hash-link" href="#installing-cis-benchmark" title="Direct link to heading">#</a></h3><ol><li>In the upper left corner, click <strong>â˜° &gt; Cluster Management</strong>.</li><li>On the <strong>Clusters</strong> page, go to the cluster where you want to install CIS Benchmark and click <strong>Explore</strong>.</li><li>In the left navigation bar, click <strong>Apps &amp; Marketplace &gt; Charts</strong>.</li><li>Click <strong>CIS Benchmark</strong></li><li>Click <strong>Install</strong>.</li></ol><p><strong>Result:</strong> The CIS scan application is deployed on the Kubernetes cluster.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="uninstalling-cis-benchmark"></a>Uninstalling CIS Benchmark<a class="hash-link" href="#uninstalling-cis-benchmark" title="Direct link to heading">#</a></h3><ol><li>From the <strong>Cluster Dashboard,</strong> go to the left navigation bar and click <strong>Apps &amp; Marketplace &gt; Installed Apps</strong>.</li><li>Go to the <code>cis-operator-system</code> namespace and check the boxes next to <code>rancher-cis-benchmark-crd</code> and <code>rancher-cis-benchmark</code>.</li><li>Click <strong>Delete</strong> and confirm <strong>Delete</strong>.</li></ol><p><strong>Result:</strong> The <code>rancher-cis-benchmark</code> application is uninstalled.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="running-a-scan"></a>Running a Scan<a class="hash-link" href="#running-a-scan" title="Direct link to heading">#</a></h3><p>When a ClusterScan custom resource is created, it launches a new CIS scan on the cluster for the chosen ClusterScanProfile.</p><p>Note: There is currently a limitation of running only one CIS scan at a time for a cluster. If you create multiple ClusterScan custom resources, they will be run one after the other by the operator, and until one scan finishes, the rest of the ClusterScan custom resources will be in the &quot;Pending&quot; state.</p><p>To run a scan,</p><ol><li>In the upper left corner, click <strong>â˜° &gt; Cluster Management</strong>.</li><li>On the <strong>Clusters</strong> page, go to the cluster where you want to run a CIS scan and click <strong>Explore</strong>.</li><li>Click <strong>CIS Benchmark &gt; Scan</strong>.</li><li>Click <strong>Create</strong>.</li><li>Choose a cluster scan profile. The profile determines which CIS Benchmark version will be used and which tests will be performed. If you choose the Default profile, then the CIS Operator will choose a profile applicable to the type of Kubernetes cluster it is installed on.</li><li>Click <strong>Create</strong>.</li></ol><p><strong>Result:</strong> A report is generated with the scan results. To see the results, click the name of the scan that appears.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="running-a-scan-periodically-on-a-schedule"></a>Running a Scan Periodically on a Schedule<a class="hash-link" href="#running-a-scan-periodically-on-a-schedule" title="Direct link to heading">#</a></h3><p>To run a ClusterScan on a schedule,</p><ol><li>In the upper left corner, click <strong>â˜° &gt; Cluster Management</strong>.</li><li>On the <strong>Clusters</strong> page, go to the cluster where you want to run a CIS scan and click <strong>Explore</strong>.</li><li>Click <strong>CIS Benchmark &gt; Scan</strong>.</li><li>Choose a cluster scan profile. The profile determines which CIS Benchmark version will be used and which tests will be performed. If you choose the Default profile, then the CIS Operator will choose a profile applicable to the type of Kubernetes cluster it is installed on.</li><li>Choose the option <strong>Run scan on a schedule</strong>.</li><li>Enter a valid \&lt;a href=&quot;<a href="https://en.wikipedia.org/wiki/Cron#CRON_expression%22" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Cron#CRON_expression&quot;</a> target=&quot;_blank&quot;&gt;cron schedule expression\&lt;/a&gt; in the field <strong>Schedule</strong>.</li><li>Choose a <strong>Retention</strong> count, which indicates the number of reports maintained for this recurring scan. By default this count is 3. When this retention limit is reached, older reports will get purged.</li><li>Click <strong>Create</strong>.</li></ol><p><strong>Result:</strong> The scan runs and reschedules to run according to the cron schedule provided. The <strong>Next Scan</strong> value indicates the next time this scan will run again. </p><p>A report is generated with the scan results every time the scan runs. To see the latest results, click the name of the scan that appears.</p><p>You can also see the previous reports by choosing the report from the <strong>Reports</strong> dropdown on the scan detail page.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="skipping-tests"></a>Skipping Tests<a class="hash-link" href="#skipping-tests" title="Direct link to heading">#</a></h3><p>CIS scans can be run using test profiles with user-defined skips.</p><p>To skip tests, you will create a custom CIS scan profile. A profile contains the configuration for the CIS scan, which includes the benchmark versions to use and any specific tests to skip in that benchmark.</p><ol><li><p>In the upper left corner, click <strong>â˜° &gt; Cluster Management</strong>.</p></li><li><p>On the <strong>Clusters</strong> page, go to the cluster where you want to run a CIS scan and click <strong>Explore</strong>.</p></li><li><p>Click <strong>CIS Benchmark &gt; Profile</strong>.</p></li><li><p>From here, you can create a profile in multiple ways. To make a new profile, click <strong>Create</strong> and fill out the form in the UI. To make a new profile based on an existing profile, go to the existing profile and click <strong>â‹® Clone</strong>.  If you are filling out the form, add the tests to skip using the test IDs, using the relevant CIS Benchmark as a reference. If you are creating the new test profile as YAML, you will add the IDs of the tests to skip in the <code>skipTests</code> directive. You will also give the profile a name:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cis.cattle.io/v1</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterScanProfile</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">meta.helm.sh/release-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> clusterscan</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">operator</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">meta.helm.sh/release-namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cis</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app.kubernetes.io/managed-by</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Helm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&lt;example-profile\&gt;&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">benchmarkVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cis</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1.5</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">skipTests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.1.20&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.1.21&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Click <strong>Create</strong>.</p></li></ol><p><strong>Result:</strong> A new CIS scan profile is created.</p><p>When you <a href="#running-a-scan">run a scan</a> that uses this profile, the defined tests will be skipped during the scan. The skipped tests will be marked in the generated report as <code>Skip</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="viewing-reports"></a>Viewing Reports<a class="hash-link" href="#viewing-reports" title="Direct link to heading">#</a></h3><p>To view the generated CIS scan reports,</p><ol><li>In the upper left corner, click <strong>â˜° &gt; Cluster Management</strong>.</li><li>On the <strong>Clusters</strong> page, go to the cluster where you want to run a CIS scan and click <strong>Explore</strong>.</li><li>Click <strong>CIS Benchmark &gt; Scan</strong>.</li><li>The <strong>Scans</strong> page will show the generated reports. To see a detailed report, go to a scan report and click the name.</li></ol><p>One can download the report from the Scans list or from the scan detail page.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="enabling-alerting-for-rancher-cis-benchmark"></a>Enabling Alerting for rancher-cis-benchmark<a class="hash-link" href="#enabling-alerting-for-rancher-cis-benchmark" title="Direct link to heading">#</a></h3><p>Alerts can be configured to be sent out for a scan that runs on a schedule.</p><p>&gt; <strong>Prerequisite:</strong>
&gt;
&gt; Before enabling alerts for <code>rancher-cis-benchmark</code>, make sure to install the <code>rancher-monitoring</code> application and configure the Receivers and Routes. For more information, see <a href="https://rancher.com/docs/rancher/v2.6/en/monitoring-alerting/configuration" target="_blank" rel="noopener noreferrer">this section.</a>
&gt;
&gt; While configuring the routes for <code>rancher-cis-benchmark</code> alerts, you can specify the matching using the key-value pair <code>job: rancher-cis-scan</code>. An example route configuration is <a href="https://rancher.com/docs/rancher/v2.6/en/monitoring-alerting/configuration/receiver/#example-route-config-for-cis-scan-alerts" target="_blank" rel="noopener noreferrer">here.</a></p><p>While installing or upgrading the <code>rancher-cis-benchmark</code> Helm chart, set the following flag to <code>true</code> in the <code>values.yaml</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">alerts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="configuring-alerts-for-a-periodic-scan-on-a-schedule"></a>Configuring Alerts for a Periodic Scan on a Schedule<a class="hash-link" href="#configuring-alerts-for-a-periodic-scan-on-a-schedule" title="Direct link to heading">#</a></h3><p>It is possible to run a ClusterScan on a schedule.</p><p>A scheduled scan can also specify if you should receive alerts when the scan completes.</p><p>Alerts are supported only for a scan that runs on a schedule.</p><p>The CIS Benchmark application supports two types of alerts:</p><ul><li>Alert on scan completion: This alert is sent out when the scan run finishes. The alert includes details including the ClusterScan&#x27;s name and the ClusterScanProfile name.</li><li>Alert on scan failure: This alert is sent out if there are some test failures in the scan run or if the scan is in a <code>Fail</code> state.</li></ul><p>&gt; <strong>Prerequisite:</strong>
&gt;
&gt; Before enabling alerts for <code>rancher-cis-benchmark</code>, make sure to install the <code>rancher-monitoring</code> application and configure the Receivers and Routes. For more information, see <a href="https://rancher.com/docs/rancher/v2.6/en/monitoring-alerting/configuration" target="_blank" rel="noopener noreferrer">this section.</a>
&gt;
&gt; While configuring the routes for <code>rancher-cis-benchmark</code> alerts, you can specify the matching using the key-value pair <code>job: rancher-cis-scan</code>. An example route configuration is <a href="https://rancher.com/docs/rancher/v2.6/en/monitoring-alerting/configuration/receiver/#example-route-config-for-cis-scan-alerts" target="_blank" rel="noopener noreferrer">here.</a></p><p>To configure alerts for a scan that runs on a schedule,</p><ol><li>Please enable alerts on the <code>rancher-cis-benchmark</code> application (#enabling-alerting-for-rancher-cis-benchmark)</li><li>In the upper left corner, click <strong>â˜° &gt; Cluster Management</strong>.</li><li>On the <strong>Clusters</strong> page, go to the cluster where you want to run a CIS scan and click <strong>Explore</strong>.</li><li>Click <strong>CIS Benchmark &gt; Scan</strong>.</li><li>Click <strong>Create</strong>.</li><li>Choose a cluster scan profile. The profile determines which CIS Benchmark version will be used and which tests will be performed. If you choose the Default profile, then the CIS Operator will choose a profile applicable to the type of Kubernetes cluster it is installed on.</li><li>Choose the option <strong>Run scan on a schedule</strong>.</li><li>Enter a valid <a href="https://en.wikipedia.org/wiki/Cron#CRON_expression" target="_blank" rel="noopener noreferrer">cron schedule expression</a> in the field <strong>Schedule</strong>.</li><li>Check the boxes next to the Alert types under <strong>Alerting</strong>.</li><li>Optional: Choose a <strong>Retention Count</strong>, which indicates the number of reports maintained for this recurring scan. By default this count is 3. When this retention limit is reached, older reports will get purged.</li><li>Click <strong>Create</strong>.</li></ol><p><strong>Result:</strong> The scan runs and reschedules to run according to the cron schedule provided. Alerts are sent out when the scan finishes if routes and receiver are configured under <code>rancher-monitoring</code> application.</p><p>A report is generated with the scan results every time the scan runs. To see the latest results, click the name of the scan that appears.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="creating-a-custom-benchmark-version-for-running-a-cluster-scan"></a>Creating a Custom Benchmark Version for Running a Cluster Scan<a class="hash-link" href="#creating-a-custom-benchmark-version-for-running-a-cluster-scan" title="Direct link to heading">#</a></h3><p>There could be some Kubernetes cluster setups that require custom configurations of the Benchmark tests. For example, the path to the Kubernetes config files or certs might be different than the standard location where the upstream CIS Benchmarks look for them.</p><p>It is now possible to create a custom Benchmark Version for running a cluster scan using the <code>rancher-cis-benchmark</code> application.</p><p>For details, see <a href="/rancher-docusaurus/cis-scans/custom-benchmark">this page.</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/versioned_docs/version-2.4.15/cis-scans/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rancher-docusaurus/cis-scans/custom-benchmark"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Creating a Custom Benchmark Version for Running a Cluster Scan</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rancher-docusaurus/cis-scans/rbac"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Roles-based Access Control Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installing-cis-benchmark" class="table-of-contents__link">Installing CIS Benchmark</a></li><li><a href="#uninstalling-cis-benchmark" class="table-of-contents__link">Uninstalling CIS Benchmark</a></li><li><a href="#running-a-scan" class="table-of-contents__link">Running a Scan</a></li><li><a href="#running-a-scan-periodically-on-a-schedule" class="table-of-contents__link">Running a Scan Periodically on a Schedule</a></li><li><a href="#skipping-tests" class="table-of-contents__link">Skipping Tests</a></li><li><a href="#viewing-reports" class="table-of-contents__link">Viewing Reports</a></li><li><a href="#enabling-alerting-for-rancher-cis-benchmark" class="table-of-contents__link">Enabling Alerting for rancher-cis-benchmark</a></li><li><a href="#configuring-alerts-for-a-periodic-scan-on-a-schedule" class="table-of-contents__link">Configuring Alerts for a Periodic Scan on a Schedule</a></li><li><a href="#creating-a-custom-benchmark-version-for-running-a-cluster-scan" class="table-of-contents__link">Creating a Custom Benchmark Version for Running a Cluster Scan</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://forums.rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://slack.rancher.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/Rancher_Labs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher Website</a></li><li class="footer__item"><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/rancher/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher Docs on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/rancher-docusaurus/assets/js/runtime~main.e49194ca.js"></script>
<script src="/rancher-docusaurus/assets/js/main.ed945e9c.js"></script>
</body>
</html>