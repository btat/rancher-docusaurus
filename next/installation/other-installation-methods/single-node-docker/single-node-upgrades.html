<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Upgrading Rancher Installed with Docker | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://btat.github.io/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-upgrades"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Upgrading Rancher Installed with Docker | My Site"><meta data-react-helmet="true" name="description" content="The following instructions will guide you through upgrading a Rancher server that was installed with Docker."><meta data-react-helmet="true" property="og:description" content="The following instructions will guide you through upgrading a Rancher server that was installed with Docker."><link data-react-helmet="true" rel="shortcut icon" href="/rancher-docusaurus/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://btat.github.io/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-upgrades"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-upgrades" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://btat.github.io/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-upgrades" hreflang="x-default"><link rel="stylesheet" href="/rancher-docusaurus/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/rancher-docusaurus/assets/js/runtime~main.e49194ca.js" as="script">
<link rel="preload" href="/rancher-docusaurus/assets/js/main.ed945e9c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rancher-docusaurus/"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/rancher-docusaurus/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Rancher Docs</b></a><a href="https://suse-projects.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>More SUSE Projects<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Rancher Deployment Quick Start Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Installing/Upgrading Rancher</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/index">Intro</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">install-rancher-on-k8s</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">other-installation-methods</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">air-gap</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">behind-proxy</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/index">Other Installation Methods</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">single-node-docker</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/advanced">Advanced Options for Docker Installs</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/index">Installing Rancher on a Single Node Using Docker</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/proxy">HTTP Proxy Configuration</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-rollbacks">Rolling Back Rancher Installed with Docker</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-upgrades">Upgrading Rancher Installed with Docker</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/troubleshooting">Certificate Troubleshooting</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">requirements</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">resources</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Best Practices Guide</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Backups and Disaster Recovery</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Authentication, Permissions and Global Configuration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Setting up Kubernetes Clusters in Rancher</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cluster Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Project Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pipelines</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deploying Applications across Clusters</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Monitoring and Alerting</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Istio</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Logging</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CIS Scans</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes Resources</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Settings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FAQ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next/cli">Using the Rancher Command Line Interface</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next/contributing">Contributing to Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next/helm-charts">Helm Charts in Rancher</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next">Rancher 2.6</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next/longhorn">Longhorn - Cloud native distributed block storage for Kubernetes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next/opa-gatekeper">OPA Gatekeeper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rancher-docusaurus/next/system-tools">System Tools</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for My Site <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/rancher-docusaurus/installation/other-installation-methods/single-node-docker/single-node-upgrades">latest version</a></b> (2.4.15).</div></div><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrading Rancher Installed with Docker</h1></header><p>The following instructions will guide you through upgrading a Rancher server that was installed with Docker.</p><header><h1>Prerequisites</h1></header><ul><li>**Review the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/install-rancher-on-k8s/upgrades/#known-upgrade-issues" target="_blank" rel="noopener noreferrer">known upgrade issues</a> in the Rancher documentation for the most noteworthy issues to consider when upgrading Rancher. A more complete list of known issues for each Rancher version can be found in the release notes on <a href="https://github.com/rancher/rancher/releases" target="_blank" rel="noopener noreferrer">GitHub</a> and on the <a href="https://forums.rancher.com/c/announcements/12" target="_blank" rel="noopener noreferrer">Rancher forums.</a> Note that upgrades to or from any chart in the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/install-rancher-on-k8s/chart-options/#helm-chart-repositories/" target="_blank" rel="noopener noreferrer">rancher-alpha repository</a> arenâ€™t supported.</li><li><strong>For <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/air-gap" target="_blank" rel="noopener noreferrer">air gap installs only,</a> collect and populate images for the new Rancher server version</strong>. Follow the guide to <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/air-gap/populate-private-registry/" target="_blank" rel="noopener noreferrer">populate your private registry</a> with the images for the Rancher version that you want to upgrade to.</li></ul><header><h1>Placeholder Review</h1></header><p>During upgrade, you&#x27;ll enter a series of commands, filling placeholders with data from your environment. These placeholders are denoted with angled brackets and all capital letters (<code>\&lt;EXAMPLE\&gt;</code>).</p><p>Here&#x27;s an <strong>example</strong> of a command with a placeholder:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker stop \&lt;RANCHER_CONTAINER_NAME\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In this command, <code>\&lt;RANCHER_CONTAINER_NAME\&gt;</code> is the name of your Rancher container.</p><header><h1>Get Data for Upgrade Commands</h1></header><p>To obtain the data to replace the placeholders, run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker ps</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Write down or copy this information before starting the upgrade.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly img"><pre tabindex="0" class="prism-code language-img codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">\&lt;sup\&gt;Terminal `docker ps` Command, Displaying Where to Find `\&lt;RANCHER_CONTAINER_TAG\&gt;` and `\&lt;RANCHER_CONTAINER_NAME\&gt;`\&lt;/sup\&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">![Placeholder Reference](./assets/img/rancher/placeholder-ref.png)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><table><thead><tr><th>Placeholder</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;RANCHER_CONTAINER_TAG\&gt;</code></td><td><code>v2.1.3</code></td><td>The rancher/rancher image you pulled for initial install.</td></tr><tr><td><code>\&lt;RANCHER_CONTAINER_NAME\&gt;</code></td><td><code>festive_mestorf</code></td><td>The name of your Rancher container.</td></tr><tr><td><code>[RANCHER_VERSION]</code></td><td><code>v2.1.3</code></td><td>The version of Rancher that you&#x27;re creating a backup for.</td></tr><tr><td><code>[DATE]</code></td><td><code>2018-12-19</code></td><td>The date that the data container or backup was created.</td></tr></tbody></table><p>You can obtain <code>\&lt;RANCHER_CONTAINER_TAG\&gt;</code> and <code>\&lt;RANCHER_CONTAINER_NAME\&gt;</code> by logging into your Rancher server by remote connection and entering the command to view the containers that are running: <code>docker ps</code>. You can also view containers that are stopped using a different command: <code>docker ps -a</code>. Use these commands for help anytime during while creating backups.</p><header><h1>Upgrade Outline</h1></header><p>During upgrade, you create a copy of the data from your current Rancher container and a backup in case something goes wrong. Then you deploy the new version of Rancher in a new container using your existing data. Follow the steps to upgrade Rancher server:</p><ul><li><a href="#1-create-a-copy-of-the-data-from-your-rancher-server-container">1. Create a copy of the data from your Rancher server container</a></li><li><a href="#2-create-a-backup-tarball">2. Create a backup tarball</a></li><li><a href="#3-pull-the-new-docker-image">3. Pull the new Docker image</a></li><li><a href="#4-start-the-new-rancher-server-container">4. Start the new Rancher server container</a></li><li><a href="#5-verify-the-upgrade">5. Verify the Upgrade</a></li><li><a href="#6-clean-up-your-old-rancher-server-container">6. Clean up your old Rancher server container</a></li></ul><header><h1>1. Create a copy of the data from your Rancher server container</h1></header><ol><li><p>Using a remote Terminal connection, log into the node running your Rancher server.</p></li><li><p>Stop the container currently running Rancher server. Replace <code>\&lt;RANCHER_CONTAINER_NAME\&gt;</code> with the name of your Rancher container.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker stop \&lt;RANCHER_CONTAINER_NAME\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>\&lt;a id=&quot;backup&quot;&gt;\&lt;/a&gt;Use the command below, replacing each placeholder, to create a data container from the Rancher container that you just stopped.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker create --volumes-from \&lt;RANCHER_CONTAINER_NAME\&gt; --name rancher-data rancher/rancher:\&lt;RANCHER_CONTAINER_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol><header><h1>2. Create a backup tarball</h1></header><ol><li><p>\&lt;a id=&quot;tarball&quot;&gt;\&lt;/a&gt;From the data container that you just created (<code>rancher-data</code>), create a backup tarball (<code>rancher-data-backup-[RANCHER_VERSION]-[DATE].tar.gz</code>).</p><p>This tarball will serve as a rollback point if something goes wrong during upgrade. Use the following command, replacing each placeholder.</p></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">```</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run --volumes-from rancher-data -v $PWD:/backup busybox tar zcvf /backup/rancher-data-backup-[RANCHER_VERSION]-[DATE].tar.gz /var/lib/rancher</span></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">**Step Result:** When you enter this command, a series of commands should run.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li><p>Enter the <code>ls</code> command to confirm that the backup tarball was created. It will have a name similar to <code>rancher-data-backup-[RANCHER_VERSION]-[DATE].tar.gz</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">[rancher@ip-10-0-0-50 ~]$ ls</span></span><span class="token-line" style="color:#393A34"><span class="token plain">rancher-data-backup-v2.1.3-20181219.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Move your backup tarball to a safe location external from your Rancher server.</p></li></ol><header><h1>3. Pull the New Docker Image</h1></header><p>Pull the image of the Rancher version that you want to upgrade to.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><header><h1>4. Start the New Rancher Server Container</h1></header><p>Start a new Rancher server container using the data from the <code>rancher-data</code> container. Remember to pass in all the environment variables that you had used when you started the original container.</p><p>&gt;<strong>Important:</strong> <em>Do not</em> stop the upgrade after initiating it, even if the upgrade process seems longer than expected. Stopping the upgrade may result in database migration errors during future upgrades.</p><p>If you used a proxy, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/proxy/" target="_blank" rel="noopener noreferrer">HTTP Proxy Configuration.</a></p><p>If you configured a custom CA root certificate to access your services, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/advanced/#custom-ca-certificate" target="_blank" rel="noopener noreferrer">Custom CA root certificate.</a></p><p>If you are recording all transactions with the Rancher API, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/advanced/#api-audit-log" target="_blank" rel="noopener noreferrer">API Auditing</a></p><p>To see the command to use when starting the new Rancher server container, choose from the following options:</p><ul><li>Docker Upgrade</li><li>Docker Upgrade for Air Gap Installs</li></ul><p>{{% tabs %}}
{{% tab &quot;Docker Upgrade&quot; %}}</p><p>Select which option you had installed Rancher server</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-a-default-self-signed-certificate"></a>Option A: Default Self-Signed Certificate<a class="hash-link" href="#option-a-default-self-signed-certificate" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-a&quot; label=&quot;Click to expand&quot; %}}</p><p>If you have selected to use the Rancher generated self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --volumes-from rancher-data \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --privileged \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a></p><p>{{% /accordion %}}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-b-bring-your-own-certificate-self-signed"></a>Option B: Bring Your Own Certificate: Self-Signed<a class="hash-link" href="#option-b-bring-your-own-certificate-self-signed" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-b&quot; label=&quot;Click to expand&quot; %}}</p><p>If you have selected to bring your own self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificate that you had originally installed with.</p><p>&gt;<strong>Reminder of the Cert Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates in the chain. Order your certificates with your certificate first, followed by the intermediates.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;CERT_DIRECTORY\&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>\&lt;FULL_CHAIN.pem\&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>\&lt;PRIVATE_KEY.pem\&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>\&lt;CA_CERTS.pem\&gt;</code></td><td>The path to the certificate authority&#x27;s certificate.</td></tr><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --volumes-from rancher-data \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;FULL_CHAIN.pem\&gt;:/etc/rancher/ssl/cert.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;PRIVATE_KEY.pem\&gt;:/etc/rancher/ssl/key.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;CA_CERTS.pem\&gt;:/etc/rancher/ssl/cacerts.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --privileged \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a></p><p>{{% /accordion %}}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-c-bring-your-own-certificate-signed-by-recognized-ca"></a>Option C: Bring Your Own Certificate: Signed by Recognized CA<a class="hash-link" href="#option-c-bring-your-own-certificate-signed-by-recognized-ca" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-c&quot; label=&quot;Click to expand&quot; %}}</p><p>If you have selected to use a certificate signed by a recognized CA, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificates that you had originally installed with. Remember to include <code>--no-cacerts</code> as an argument to the container to disable the default CA certificate generated by Rancher.</p><p>&gt;<strong>Reminder of the Cert Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates provided by the recognized CA. Order your certificates with your certificate first, followed by the intermediates. For an example, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/troubleshooting" target="_blank" rel="noopener noreferrer">Certificate Troubleshooting.</a></p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;CERT_DIRECTORY\&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>\&lt;FULL_CHAIN.pem\&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>\&lt;PRIVATE_KEY.pem\&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --volumes-from rancher-data \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;FULL_CHAIN.pem\&gt;:/etc/rancher/ssl/cert.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;PRIVATE_KEY.pem\&gt;:/etc/rancher/ssl/key.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --privileged \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt; \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --no-cacerts</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a>
{{% /accordion %}}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-d-lets-encrypt-certificate"></a>Option D: Let&#x27;s Encrypt Certificate<a class="hash-link" href="#option-d-lets-encrypt-certificate" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-d&quot; label=&quot;Click to expand&quot; %}}</p><p>&gt;<strong>Remember:</strong> Let&#x27;s Encrypt provides rate limits for requesting new certificates. Therefore, limit how often you create or destroy the container. For more information, see <a href="https://letsencrypt.org/docs/rate-limits/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt documentation on rate limits</a>.</p><p>If you have selected to use <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt</a> certificates, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to provide the domain that you had used when you originally installed Rancher.</p><p>&gt;<strong>Reminder of the Cert Prerequisites:</strong>
&gt;
&gt;- Create a record in your DNS that binds your Linux host IP address to the hostname that you want to use for Rancher access (<code>rancher.mydomain.com</code> for example).
&gt;- Open port <code>TCP/80</code> on your Linux host. The Let&#x27;s Encrypt http-01 challenge can come from any source IP address, so port <code>TCP/80</code> must be open to all IP addresses.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr><tr><td><code>\&lt;YOUR.DNS.NAME\&gt;</code></td><td>The domain address that you had originally started with</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --volumes-from rancher-data \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --privileged \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt; \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  --acme-domain \&lt;YOUR.DNS.NAME\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a></p><p>{{% /accordion %}}</p><p>{{% /tab %}}
{{% tab &quot;Docker Air Gap Upgrade&quot; %}}</p><p>For security purposes, SSL (Secure Sockets Layer) is required when using Rancher. SSL secures all Rancher network communication, like when you login or interact with a cluster.</p><p>When starting the new Rancher server container, choose from the following options:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-a-default-self-signed-certificate-1"></a>Option A: Default Self-Signed Certificate<a class="hash-link" href="#option-a-default-self-signed-certificate-1" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-a&quot; label=&quot;Click to expand&quot; %}}</p><p>If you have selected to use the Rancher generated self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>[REGISTRY.YOURDOMAIN.COM:PORT]</code></td><td>Your private registry URL and port.</td></tr><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  docker run -d --volumes-from rancher-data \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -e CATTLE_SYSTEM_DEFAULT_REGISTRY=[REGISTRY.YOURDOMAIN.COM:PORT] \ # Set a default private registry to be used in Rancher</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -e CATTLE_SYSTEM_CATALOG=bundled \ # Use the packaged Rancher system charts</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      --privileged \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      [REGISTRY.YOURDOMAIN.COM:PORT]/rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a>
{{% /accordion %}}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-b-bring-your-own-certificate-self-signed-1"></a>Option B: Bring Your Own Certificate: Self-Signed<a class="hash-link" href="#option-b-bring-your-own-certificate-self-signed-1" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-b&quot; label=&quot;Click to expand&quot; %}}</p><p>If you have selected to bring your own self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificate that you had originally installed with.</p><p>&gt;<strong>Reminder of the Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates in the chain. Order your certificates with your certificate first, followed by the intermediates. For an example, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/troubleshooting" target="_blank" rel="noopener noreferrer">Certificate Troubleshooting.</a></p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;CERT_DIRECTORY\&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>\&lt;FULL_CHAIN.pem\&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>\&lt;PRIVATE_KEY.pem\&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>\&lt;CA_CERTS.pem\&gt;</code></td><td>The path to the certificate authority&#x27;s certificate.</td></tr><tr><td><code>[REGISTRY.YOURDOMAIN.COM:PORT]</code></td><td>Your private registry URL and port.</td></tr><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;FULL_CHAIN.pem\&gt;:/etc/rancher/ssl/cert.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;PRIVATE_KEY.pem\&gt;:/etc/rancher/ssl/key.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;CA_CERTS.pem\&gt;:/etc/rancher/ssl/cacerts.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    -e CATTLE_SYSTEM_DEFAULT_REGISTRY=[REGISTRY.YOURDOMAIN.COM:PORT] \ # Set a default private registry to be used in Rancher</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    -e CATTLE_SYSTEM_CATALOG=bundled \ # Use the packaged Rancher system charts</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --privileged \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    [REGISTRY.YOURDOMAIN.COM:PORT]/rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a>
{{% /accordion %}}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-c-bring-your-own-certificate-signed-by-recognized-ca-1"></a>Option C: Bring Your Own Certificate: Signed by Recognized CA<a class="hash-link" href="#option-c-bring-your-own-certificate-signed-by-recognized-ca-1" title="Direct link to heading">#</a></h3><p>{{% accordion id=&quot;option-c&quot; label=&quot;Click to expand&quot; %}}</p><p>If you have selected to use a certificate signed by a recognized CA, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificates that you had originally installed with.</p><p> &gt;<strong>Reminder of the Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates provided by the recognized CA. Order your certificates with your certificate first, followed by the intermediates. For an example, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/troubleshooting" target="_blank" rel="noopener noreferrer">Certificate Troubleshooting.</a></p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>\&lt;CERT_DIRECTORY\&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>\&lt;FULL_CHAIN.pem\&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>\&lt;PRIVATE_KEY.pem\&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>[REGISTRY.YOURDOMAIN.COM:PORT]</code></td><td>Your private registry URL and port.</td></tr><tr><td><code>\&lt;RANCHER_VERSION_TAG\&gt;</code></td><td>The release tag of the <a href="https://rancher.com/docs/rancher/v2.6/en/installation/resources/chart-options/" target="_blank" rel="noopener noreferrer">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><p>&gt; <strong>Note:</strong>  Use the <code>--no-cacerts</code> as argument to the container to disable the default CA certificate generated by Rancher.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --volumes-from rancher-data \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --restart=unless-stopped \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     -p 80:80 -p 443:443 \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     --no-cacerts \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;FULL_CHAIN.pem\&gt;:/etc/rancher/ssl/cert.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     -v /\&lt;CERT_DIRECTORY\&gt;/\&lt;PRIVATE_KEY.pem\&gt;:/etc/rancher/ssl/key.pem \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     -e CATTLE_SYSTEM_DEFAULT_REGISTRY=[REGISTRY.YOURDOMAIN.COM:PORT] \ # Set a default private registry to be used in Rancher</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     -e CATTLE_SYSTEM_CATALOG=bundled \ # Use the packaged Rancher system charts</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     --privileged</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     [REGISTRY.YOURDOMAIN.COM:PORT]/rancher/rancher:\&lt;RANCHER_VERSION_TAG\&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>privileged access is <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/#privileged-access-for-rancher" target="_blank" rel="noopener noreferrer">required.</a>
{{% /accordion %}}
{{% /tab %}}
{{% /tabs %}}</p><p><strong>Result:</strong> You have upgraded Rancher. Data from your upgraded server is now saved to the <code>rancher-data</code> container for use in future upgrades.</p><header><h1>5. Verify the Upgrade</h1></header><p>Log into Rancher. Confirm that the upgrade succeeded by checking the version displayed in the bottom-left corner of the browser window.</p><p>&gt;<strong>Having network issues in your user clusters following upgrade?</strong>
&gt;
&gt; See <a href="https://rancher.com/docs/rancher/v2.0-v2.4/en/installation/install-rancher-on-k8s/upgrades/namespace-migration" target="_blank" rel="noopener noreferrer">Restoring Cluster Networking</a>.</p><header><h1>6. Clean up Your Old Rancher Server Container</h1></header><p>Remove the previous Rancher server container. If you only stop the previous Rancher server container (and don&#x27;t remove it), the container may restart after the next server reboot.</p><header><h1>Rolling Back</h1></header><p>If your upgrade does not complete successfully, you can roll back Rancher server and its data back to its last healthy state. For more information, see <a href="https://rancher.com/docs/rancher/v2.6/en/installation/other-installation-methods/single-node-docker/single-node-rollbacks/" target="_blank" rel="noopener noreferrer">Docker Rollback</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/installation/other-installation-methods/single-node-docker/single-node-upgrades.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/single-node-rollbacks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Rolling Back Rancher Installed with Docker</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rancher-docusaurus/next/installation/other-installation-methods/single-node-docker/troubleshooting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Certificate Troubleshooting Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#option-a-default-self-signed-certificate" class="table-of-contents__link">Option A: Default Self-Signed Certificate</a></li><li><a href="#option-b-bring-your-own-certificate-self-signed" class="table-of-contents__link">Option B: Bring Your Own Certificate: Self-Signed</a></li><li><a href="#option-c-bring-your-own-certificate-signed-by-recognized-ca" class="table-of-contents__link">Option C: Bring Your Own Certificate: Signed by Recognized CA</a></li><li><a href="#option-d-lets-encrypt-certificate" class="table-of-contents__link">Option D: Let&#39;s Encrypt Certificate</a></li><li><a href="#option-a-default-self-signed-certificate-1" class="table-of-contents__link">Option A: Default Self-Signed Certificate</a></li><li><a href="#option-b-bring-your-own-certificate-self-signed-1" class="table-of-contents__link">Option B: Bring Your Own Certificate: Self-Signed</a></li><li><a href="#option-c-bring-your-own-certificate-signed-by-recognized-ca-1" class="table-of-contents__link">Option C: Bring Your Own Certificate: Signed by Recognized CA</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://forums.rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://slack.rancher.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/Rancher_Labs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://rancher.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher Website</a></li><li class="footer__item"><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/rancher/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Rancher Docs on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/rancher-docusaurus/assets/js/runtime~main.e49194ca.js"></script>
<script src="/rancher-docusaurus/assets/js/main.ed945e9c.js"></script>
</body>
</html>